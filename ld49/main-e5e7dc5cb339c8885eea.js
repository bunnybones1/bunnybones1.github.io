!function(e){function webpackJsonpCallback(t){for(var r,s,o=t[0],c=t[1],h=t[2],l=0,u=[];l<o.length;l++)s=o[l],n[s]&&u.push(n[s][0]),n[s]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(a&&a(t);u.length;)u.shift()();return i.push.apply(i,h||[]),checkDeferredModules()}function checkDeferredModules(){for(var e,t=0;t<i.length;t++){for(var r=i[t],s=!0,o=1;o<r.length;o++){var a=r[o];0!==n[a]&&(s=!1)}s&&(i.splice(t--,1),e=__webpack_require__(__webpack_require__.s=r[0]))}return e}var t={},n={0:0},i=[];function __webpack_require__(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,__webpack_require__),i.l=!0,i.exports}__webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,n){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.t=function(e,t){if(1&t&&(e=__webpack_require__(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(__webpack_require__.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)__webpack_require__.d(n,i,function(t){return e[t]}.bind(null,i));return n},__webpack_require__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e.default}:function getModuleExports(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="/";var r=window.webpackJsonp=window.webpackJsonp||[],s=r.push.bind(r);r.push=webpackJsonpCallback,r=r.slice();for(var o=0;o<r.length;o++)webpackJsonpCallback(r[o]);var a=s;i.push([108,1]),checkDeferredModules()}([,,function(e,t,n){"use strict";const i=new class Device{constructor(){this.targetFPS=60,this.listeners=new Set,this.cachedPPCm=-1,this.handleChange=()=>{this.useTouch=/Mobi|Android|iPhone|iPad|BlackBerry|Windows Phone|webOS/i.test(navigator.userAgent),this.width===window.innerWidth&&this.height===window.innerHeight||(this.width=window.innerWidth,this.height=window.innerHeight,this.aspect=this.width/this.height,this.deviceHeight=Math.min(this.width,this.height),this.deviceWidth=Math.max(this.width,this.height),this.deviceAspect=this.deviceWidth/this.deviceHeight,this.pixelRatio=window.devicePixelRatio,this.orientation=this.aspect<1?"portrait":"landscape",this.type=this.useTouch?this.deviceWidth<1024&&this.deviceAspect>1.6?"mobile":"tablet":"desktop",this.listeners.forEach(e=>e()))},window.addEventListener("resize",()=>{this.handleChange(),setTimeout(this.handleChange,50)}),this.handleChange()}onChange(e,t=!1){return this.listeners.add(e),t&&e(),()=>this.listeners.delete(e)}get isMobile(){return"mobile"===this.type}get isTablet(){return"tablet"===this.type}get isDesktop(){return"desktop"===this.type}get pixelsPerCm(){if(-1===this.cachedPPCm){const e=document.createElement("div");e.style.height="1in";const t=document.getElementsByTagName("body")[0];t.appendChild(e);const n=getComputedStyle(e,null).getPropertyValue("height");t.removeChild(e),this.cachedPPCm=2.54*parseFloat(n)}return this.cachedPPCm}get screenHeightCms(){return this.height/this.pixelsPerCm}get screenWidthCms(){return this.width/this.pixelsPerCm}get screenShorterCms(){return Math.min(this.width,this.height)/this.pixelsPerCm}setFPS(e=60){this.targetFPS=e}};window.device=i,t.a=i},function(e,t,n){"use strict";n.d(t,"d",function(){return createPhysicBoxFromPixels}),n.d(t,"g",function(){return createStaticBox}),n.d(t,"f",function(){return createSensorBox}),n.d(t,"b",function(){return createArchitectMeshAndFixtures}),n.d(t,"k",function(){return getContactBetweenSensorAndRigidBody}),n.d(t,"h",function(){return deconstructConcavePath2}),n.d(t,"i",function(){return deconstructConcavePath3}),n.d(t,"j",function(){return makePolygonPhysics}),n.d(t,"n",function(){return textToPhysicsBodies}),n.d(t,"a",function(){return convertTob2Space}),n.d(t,"l",function(){return makeBitMask}),n.d(t,"o",function(){return translateCategoryBitsToString}),n.d(t,"e",function(){return createPhysicsCircle}),n.d(t,"c",function(){return createImprovedPhysicsCircle}),n.d(t,"m",function(){return queryForSingleArchitectureBody});var i=n(1),r=n(0),s=n(2),o=n(8),a=n(7),c=n(6),h=n(4),l=n(10),u=n(17),d=n(41),f=n(57);function createPhysicBoxFromPixels(e,t,n,r,s,o=!1){createStaticBox(e,(t+-16-.5*r)*a.c,(8-n-.5*s)*a.c,r*a.c,s*a.c,i.BodyType.b2_staticBody,void 0,void 0,o)}function createStaticBox(e,t,n,r,s,o=i.BodyType.b2_staticBody,a=.1,c=1,h=!1){const u=new i.BodyDef,d=new i.FixtureDef;u.fixedRotation=!1,u.type=o;const f=Object(l.a)().createBody(u);f.SetPositionXY(t,n),d.friction=a,d.restitution=.7,d.density=c,d.isSensor=h,o===i.BodyType.b2_staticBody&&(d.filter.categoryBits=makeBitMask(["environment"]));const p=(new i.PolygonShape).SetAsBox(.5*r,.5*s);return d.shape=p,f.CreateFixture(d),f}function createSensorBox(e,t,n,r,s,o,a,c=i.BodyType.b2_staticBody,h=.1,u=1,d=!0,f){const p=new i.BodyDef,y=new i.FixtureDef;p.fixedRotation=!1,p.type=c,p.userData=f;const g=Object(l.a)().createBody(p);g.SetPositionXY(t,n),y.friction=h,y.restitution=.7,y.density=u,y.isSensor=d,o&&a&&(y.filter.categoryBits=makeBitMask(o),y.filter.maskBits=makeBitMask(a));const m=(new i.PolygonShape).SetAsBox(.5*r,.5*s);return y.shape=m,g.CreateFixture(y),g}async function createArchitectMeshAndFixtures(e){var t,n;const r=new i.BodyDef;r.fixedRotation=!1,r.type=null!==(t=e.bodyType)&&void 0!==t?t:i.BodyType.b2_dynamicBody,r.userData=e;const s=Object(l.a)().createBody(r);s.SetPositionXY(e.x,e.y),s.SetAngle(e.angle);const o=await Object(d.a)(s,e.meshName,null!==(n=e.colliderName)&&void 0!==n?n:"collider",e.categoryArray,e.maskArray);return Object(u.a)().createBody(s,o),{body:s,mesh:o}}const p=new class ContactPair{set(e,t){return this.sensor=e,this.rigidBody=t,this}};function getContactBetweenSensorAndRigidBody(e){const t=e.GetFixtureA(),n=e.GetFixtureB();if(t.m_isSensor!==n.m_isSensor)return t.m_isSensor?p.set(t,n):p.set(n,t)}const y=new r.Vector2;class AngledVec2{constructor(e,t){this.vec=e,this.angle=t}}function updateAngle(e,t){const n=t.indexOf(e.vec);return function updateAngledVec(e,t,n){const i=y.subVectors(t,e.vec).angle(),r=y.subVectors(e.vec,n).angle();e.angle=Object(h.j)(r-i,-Math.PI,Math.PI)}(e,Object(c.c)(t,n-1),Object(c.c)(t,n+1)),e}function deconstructConcavePath2(e){const t=[],n=e.slice(),i=e.map(e=>updateAngle(new AngledVec2(e,0),n));for(;n.length>=3;){i.sort((e,t)=>t.angle-e.angle);const e=i.shift(),r=n.indexOf(e.vec),s=[Object(c.c)(n,r-1),e.vec,Object(c.c)(n,r+1)];n.splice(r,1);for(const e of i)-1!==s.indexOf(e.vec)&&updateAngle(e,n);t.push(s)}return t.map(e=>Array.from(new Set(e))).filter(e=>e.length>=3)}class Edge{constructor(e,t){this.v1=e,this.v2=t}}function deconstructConcavePath3(e){const t=deconstructConcavePath2(e);console.warn("Not done yet.");const n=new Map;function findOrSet(e,t){return n.has(e)?n.get(e):void n.set(e,t)}for(const n of t)for(const t of n){const i=Object(c.b)(n,t),r=e.indexOf(t),s=e.indexOf(i);let o;o=r<s?findOrSet(r+"-"+s,new Edge(t,i)):findOrSet(s+"-"+r,new Edge(i,t))}return t}const g=new r.Vector2;function makePolygonPhysics(e,t,n=i.BodyType.b2_staticBody,r=g,s=function deconstructConcavePath(e){const t=[];let n,i=5;do{n=[],i--;let r=[];for(let i=0;i<e.length;i++){const s=Object(c.c)(e,i-1),o=Object(c.c)(e,i),a=Object(c.c)(e,i+1),l=y.subVectors(s,o).angle(),u=y.subVectors(o,a).angle();Object(h.j)(u-l,-Math.PI,Math.PI)>=0?r.push(s,o,a):(n.push(o),t.push(r),r=[o])}t.push(r),e=n}while(n.length>3&&i>0);return t.map(e=>Array.from(new Set(e))).filter(e=>e.length>=3)}){const o=new i.BodyDef;o.type=n,e||(e=Object(l.a)().createBody(o)),e.SetPositionXY(r.x,r.y);const a=s(t);for(const t of a){if(t.length<3)continue;const n=new i.FixtureDef,r=new i.PolygonShape;r.Set(t),n.shape=r,n.filter.categoryBits=makeBitMask(["environment"]),e.CreateFixture(n)}return e}function textToPhysicsBodies(e,t){const n=[];if(e.geometry instanceof r.BufferGeometry){const t=e.geometry.attributes.position.array,i=4*e.geometry.attributes.position.itemSize,r=e.position;for(let e=0;e<t.length;e+=i){const i=t[e+0],s=t[e+4],o=t[e+1],c=t[e+3],h=createStaticBox(0,5.275*((i+s)/2+r.x*a.c-.1),5.275*((o+c)/2+r.y*a.c),5.275*(s-i),6.5*(o-c));n.push(h)}}return n}function convertTob2Space(e,t,n){const r=new i.Vec2,a=(t/s.a.width*2-1)*(1/o.c)*s.a.aspect+e.offset.x,c=-(n/s.a.height*2-1)*(1/o.c)+e.offset.y;return r.Set(a,c),r}const m=["environment","architecture","penalty","goal","enemyWeapon","sound","noiseMaker","item","stink"];function makeBitMask(e){let t=0;for(const n of e)t|=Math.pow(2,m.indexOf(n)+1);return t}function translateCategoryBitsToString(e){const t=e.toString(2);if(t.indexOf("1")!==t.lastIndexOf("1"))throw new Error("Category Bits not a power of 2");const n=Math.log2(e)-1;return m[n]}function createPhysicsCircle(e,t,n,r,s=!0){const o=new i.CircleShape(r),a=new i.FixtureDef;a.shape=o,a.density=1,a.friction=.2,a.restitution=.7;const c=new i.BodyDef;c.type=i.BodyType.b2_dynamicBody;const h=Object(l.a)().createBody(c);return h.SetPositionXY(t,n),h.CreateFixture(a),h}function createImprovedPhysicsCircle(e,t,n,r,s,o,a,c,h,u,d){const f=new i.CircleShape(r),p=new i.FixtureDef;p.shape=f,p.density=1,u&&(p.density=u),p.friction=.2,p.restitution=.7;const y=new i.BodyDef;y.userData=a,y.type=d||i.BodyType.b2_dynamicBody,s&&o&&(p.filter.categoryBits=makeBitMask(s),p.filter.maskBits=makeBitMask(o)),c&&(p.isSensor=!0),h&&(y.bullet=!0);const g=Object(l.a)().createBody(y);return g.SetPositionXY(t,n),g.CreateFixture(p),g}new f.b(void 0);const w=new f.a(void 0);function queryForSingleArchitectureBody(e,t,n){n||(n=.001);const r=new i.AABB;return r.lowerBound.Set(t.x-n,t.y-n),r.upperBound.Set(t.x+n,t.y+n),w.reset(),w.clickedGameSpace=t,e.QueryAABB(w,r),w.architectureBody?w.architectureBody:void 0}},function(e,t,n){"use strict";n.d(t,"b",function(){return clamp}),n.d(t,"j",function(){return wrap}),n.d(t,"a",function(){return absFloor}),n.d(t,"c",function(){return hitTestPlaneAtPixel}),n.d(t,"e",function(){return lerp}),n.d(t,"i",function(){return unlerpClamped}),n.d(t,"f",function(){return rand}),n.d(t,"h",function(){return randInt}),n.d(t,"g",function(){return rand2}),n.d(t,"d",function(){return inferDirection});var i=n(1),r=n(0);n(2);function clamp(e,t,n){return Math.min(n,Math.max(t,e))}function wrap(e,t,n){const i=n-t;return((e-t)%i+i)%i+t}function absFloor(e){return Math.floor(Math.abs(e))*(e<0?-1:1)}Math.PI,Math.PI,Math.PI;new r.Ray,new r.Plane(new r.Vector3(0,-1,0),1),new r.Plane(new r.Vector3(0,-1,0),1),new r.Vector3;new r.Vector2,new r.Raycaster;const s=new r.Ray,o=new r.Vector3;function hitTestPlaneAtPixel(e,t,n,i){return i instanceof r.PerspectiveCamera?(s.origin.setFromMatrixPosition(i.matrixWorld),s.direction.set(e,t,.5).unproject(i).sub(s.origin).normalize()):i instanceof r.OrthographicCamera?(s.origin.set(e,t,(i.near+i.far)/(i.near-i.far)).unproject(i),s.direction.set(0,0,-1).transformDirection(i.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type: "+i.type),s.intersectPlane(n,o)?o:null}function lerp(e,t,n){const i=e+n*(t-e);return Math.abs(t-i)>1e-5?i:t}function unlerpClamped(e,t,n){return clamp(function unlerp(e,t,n){return(n-e)/(t-e)}(e,t,n),0,1)}Math.PI,Math.PI;function rand(e=0,t=1){return Math.random()*(t-e)+e}function randInt(e=1,t=0){return~~(Math.random()*e)+t}function rand2(e=1,t=0){return(2*Math.random()-1)*e+t}function inferDirection(e,t=1e-5){return e<-t?-1:e>t?1:0}new i.Vec2},function(e,t,n){"use strict";n.d(t,"e",function(){return getUrlParam}),n.d(t,"b",function(){return getUrlFlag}),n.d(t,"c",function(){return getUrlFloat}),n.d(t,"d",function(){return getUrlInt}),n.d(t,"a",function(){return getUrlColor});var i=n(0),r=n(40),s=n(4);function getUrlParam(e){return function __setReminder(e){o.includes(e)||(o.push(e),a||(a=!0,setTimeout(()=>{console.log("Nice Parameters to try: "+o.join(", ")),a=!1},2e3)))}(e),new URL(window.location.href).searchParams.get(e)}function getUrlFlag(e){const t=getUrlParam(e);return!!(""===t||t&&"false"!==t)}function __getUrlNumber(e,t,n,i=-1/0,r=1/0){return Object(s.b)(n(getUrlParam(e)||t.toString()),i,r)}function getUrlFloat(e,t,n=-1/0,i=1/0){return __getUrlNumber(e,t,parseFloat,n,i)}function getUrlInt(e,t,n=-1/0,i=1/0){return __getUrlNumber(e,t,parseInt,n,i)}function getUrlColor(e,t){let n=getUrlParam(e);if(!n){if(t instanceof i.Color)return t;n=t}return Object(r.a)("#"+n)}const o=[];let a=!1},function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"d",function(){return r}),n.d(t,"a",function(){return s}),n.d(t,"c",function(){return getArrWrap}),n.d(t,"b",function(){return getArrNext});n(4);const i=(e,t,n=!1)=>{const i=e.indexOf(t);if(-1!==i)e.splice(i,1);else if(n)throw new Error("could not find value in array");return t};const r=(e,t,n,i=!1)=>{e.has(t)||e.set(t,[]);const r=e.get(t);r&&(i?-1===r.indexOf(n)&&r.push(n):r.push(n))},s=(e,t,n)=>{if(!e.has(t))return;const r=e.get(t);r&&(i(r,n),0===r.length&&e.delete(t))};function getArrWrap(e,t){const n=e.length;return e[(t%n+n)%n]}function getArrNext(e,t){return getArrWrap(e,e.indexOf(t)+1)}},function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"c",function(){return s}),n.d(t,"d",function(){return o}),n.d(t,"a",function(){return a});var i=n(5);const r=Object(i.b)("resetSettings"),s=.05,o=.2,a=.5},function(e,t,n){"use strict";n.d(t,"c",function(){return h}),n.d(t,"b",function(){return g}),n.d(t,"a",function(){return Box2DPreviewMesh});var i=n(1),r=n(0),s=n(2),o=n(71),a=n(5),c=n(4);let h=.6;const l=16,u=6,d=new r.Vector3(1,0,0),f=(new r.Matrix4).compose(new r.Vector3(.5,.5,.5),new r.Quaternion,new r.Vector3(.5,.5,.5)),p=new r.Quaternion,y=new r.Vector3(.5,.5,.5),g={value:Object(a.b)("debugPhysicsPolygon")};class DebugColors{constructor(){this.fixtureColors=new Map,this.bodyMatrices=new Map}getFixtureColor(e){if(!this.fixtureColors.has(e)){const t=new r.Vector3(Object(c.g)(),Object(c.g)(),Object(c.g)()).applyMatrix4(this.getBodyMatrix(e.m_body)).applyMatrix4(f);return this.fixtureColors.set(e,t),t}return this.fixtureColors.get(e)}getBodyMatrix(e){if(!this.bodyMatrices.has(e)){const t=(new r.Matrix4).compose(new r.Vector3(Object(c.g)(.5,.5),Object(c.g)(.5,.5),Object(c.g)(.5,.5)),p,y);return this.bodyMatrices.set(e,t),t}return this.bodyMatrices.get(e)}}function getShapeWorldVerts(e,t){switch(e.m_type){case i.ShapeType.e_polygonShape:return g.value?function getPolygonShapeWorldVerts(e,t){return e.m_vertices.map(e=>{const n=new i.Vec2;return t.GetWorldPoint(e,n),n.x/=s.a.aspect,n})}(e,t):void 0;case i.ShapeType.e_circleShape:return function getCircleShapeWorldVerts(e,t){const n=[],r=e.m_radius,o=e.m_p;for(let e=0;e<l;e++){const a=e/l*Math.PI*2,c=new i.Vec2(Math.cos(a)*r,Math.sin(a)*r).SelfAdd(o),h=new i.Vec2;t.GetWorldPoint(c,h),h.x/=s.a.aspect,n.push(h)}return n}(e,t);default:return void console.error("unsupported box2d shape type for debug view")}}function getShapeWorldVertsCount(e){switch(e.m_type){case i.ShapeType.e_polygonShape:return g.value?e.m_vertices.length:0;case i.ShapeType.e_circleShape:return l;default:return 0}}function getContactWorldVerts(e){const t=[];for(let n=0;n<u;n++){const r=n/u*Math.PI*2,o=new i.Vec2(.02*Math.cos(r),.02*Math.sin(r)).SelfAdd(e);o.x/=s.a.aspect,t.push(o)}return t}function createGeometry(e,t,n){let o=0,a=e.m_bodyList;for(;a;){let e=a.m_fixtureList;for(;e;)o+=getShapeWorldVertsCount(e.m_shape)+3,e=e.m_next;a=a.m_next}const c=e.GetContactManager();let l=c.m_contactList;for(;l;)l.IsTouching()&&(o+=2*(u+3)),l=l.m_next;const f=new r.BufferGeometry;f.boundingSphere=new r.Sphere(void 0,1/0);const p=new Float32Array(2*o),y=new Float32Array(4*o);let g=0,m=0;function writeVert(e,t,n=1){p[g]=e.x,p[g+1]=e.y,g+=2,t.toArray(y,m),y[m+3]=n,m+=4}a=e.m_bodyList;const w=new i.Vec2(n.x/s.a.aspect,n.y);for(;a;){let e=a.m_fixtureList;for(;e;){const n=getShapeWorldVerts(e.m_shape,a);if(n){addVertsToGeometry(n,t.getFixtureColor(e))}e=e.m_next}a=a.m_next}for(l=c.m_contactList;l;){if(l.IsTouching())for(const e of[l.GetFixtureA(),l.GetFixtureB()]){addVertsToGeometry(getContactWorldVerts(e.GetBody().GetPosition()),d)}l=l.m_next}return f.setAttribute("position",new r.Float32BufferAttribute(p,2)),f.setAttribute("color",new r.Float32BufferAttribute(y,4)),f;function addVertsToGeometry(e,t){if(0!==n.x||0!==n.y)for(const t of e)t.SelfSub(w);if("landscape"===s.a.orientation&&s.a.isMobile?h=1.2:"portrait"===s.a.orientation&&s.a.isMobile&&(h=.55),1!==h)for(const t of e)t.SelfMul(h);const i=e[0];writeVert(i,t,0);for(const n of e)writeVert(n,t,1);writeVert(i,t,1),writeVert(i,t,0)}}class Box2DPreviewMesh extends r.Line{constructor(e){const t=new DebugColors,n=new i.Vec2;super(createGeometry(e,t,n),new o.a),this.debugColors=t,this.b2World=e,this.offset=n,this.renderOrder=1e5}update(e){this.geometry.dispose(),this.geometry=createGeometry(this.b2World,this.debugColors,this.offset)}}},function(e,t,n){"use strict";n.d(t,"a",function(){return TestPhysicsScene});var i=n(1),r=n(8),s=n(10),o=n(3),a=n(4),c=n(20);class TestPhysicsScene extends c.a{constructor(e=!0,t=20,n=!0){super(),this.circleBodies=[];const c=new i.World(new i.Vec2(0,-9.8));Object(s.a)().init(c);const h=new r.a(c);this.scene.add(h),this.b2World=c,this.b2Preview=h;for(let e=0;e<t;e++){const e=Object(o.e)(this.b2World,Object(a.f)(-1,1),1+Object(a.f)(-.2,.2),.05,n);this.circleBodies.push(e)}if(e){Object(o.g)(this.b2World,0,-.3,1,.1),Object(o.g)(this.b2World,.2,.3,1,.1),Object(o.g)(this.b2World,1.8,0,1,.1).SetAngle(.25*Math.PI)}}update(e){super.update(e),this.b2World.Step(e,10,4),this.b2Preview.update(e);for(const e of this.circleBodies){e.GetPosition().y<-2&&(e.SetLinearVelocity(new i.Vec2(0,0)),e.SetPositionXY(Object(a.f)(-1,1),1+Object(a.f)(-.2,.2)))}}render(e,t){super.render(e,t)}}},function(e,t,n){"use strict";n.d(t,"a",function(){return getBodyEventManager});var i=n(6);class BodyEventManager{constructor(){this.bodies=[],this.createCallbacks=[],this.destroyCallbacks=[]}init(e){if(this.world)throw new Error("cannot initialize twice");this.world=e}createBody(e){const t=this.world.CreateBody(e);for(const e of this.createCallbacks)e(t);return this.bodies.push(t),t}destroyBody(e){Object(i.e)(this.bodies,e);for(const t of this.destroyCallbacks)t(e);this.world.DestroyBody(e)}startListeningForCreate(e){for(const t of this.bodies)e(t);this.createCallbacks.push(e)}startListeningForDestroy(e){this.destroyCallbacks.push(e)}}let r;function getBodyEventManager(){return r||(r=new BodyEventManager),r}},function(e,t,n){"use strict";n.d(t,"a",function(){return TextMesh});var i=n(0),r=n(76),s=n.n(r),o=n(22),a=n(58),c=n(45),h=n(46),l=n(16),u=n(77),d=n.n(u),f=n(14),p=n(79),y=n.n(p);class Gradient{constructor(e){Object.keys(e).forEach(t=>{const n=e[t];if(n){const e=_(n);this[t]=e}})}set top(e){this.topLeft=_(e),this.topRight=_(e)}set bottom(e){this.bottomLeft=_(e),this.bottomRight=_(e)}set left(e){this.topLeft=_(e),this.bottomLeft=_(e)}set right(e){this.topRight=_(e),this.bottomRight=_(e)}}const g=new i.Matrix4,m=[];class TextMesh extends i.Mesh{constructor(e="",t=f.a.generic,n,i,r,s=!0){super(v(e,t),w(t)),this.onFontFaceChange=(e,t)=>{t&&(Object(l.b)(t,"msdfTexture",this.onFontTextureUpdate),Object(l.b)(t,"font",this.onFontUpdate)),Object(l.a)(e,"msdfTexture",this.onFontTextureUpdate),Object(l.a)(e,"font",this.onFontUpdate),e.init(),this._fontFace=e},this.onFontTextureUpdate=e=>{this.newTexture=e,this.dirty=!0},this.onFontUpdate=e=>{this.dirty=!0},this.onBeforeRender=(e,t,n,i,r,s)=>{if(this.settings.screenSpace){const e=this.material.uniforms.clipSpacePosition.value;g.multiplyMatrices(n.matrixWorldInverse,this.matrixWorld).premultiply(n.projectionMatrix),e.set(0,0,0,1).applyMatrix4(g)}this.dirty&&(this.dirty=!1,this.regenerateGeometry(),this.newTexture&&(this.optimizeRenderOrder&&(this.renderOrder=this.renderOrder||100+function getFontFaceSubOrder(e){if(!e)return-1;const t=m.indexOf(e);return-1===t?(m.push(e),m.length-1):t}(this.newTexture)),this.material.uniforms.msdf.value=this.newTexture,this.newTexture=void 0))},this.updateText=(e="")=>{this.text=`${e}`},this.onMeasurementsUpdated=r,this.optimizeRenderOrder=s,Object(l.a)(t,"fontFace",this.onFontFaceChange,!0),this._text=e,this.updateMeasurements(),this.userData.isFrontFacing=!0,this.userData.doNotBillboard=!0,this.settings=t,this.livePropObject=n,this.livePropName=i,this.frustumCulled=!1}set text(e){"number"==typeof e&&(e=String(e)),this._text!==e&&(this._text=e,this.dirty=!0)}set color(e){"object"!=typeof e&&(e=_(e)),this._globalColor=e;const{topLeft:t,topRight:n,bottomLeft:i,bottomRight:r}=C(e),s=this.geometry.getAttribute("color");if(s){const e=s.array;for(let s=0;s<e.length;s+=12)e.set(t,s+0),e.set(i,s+3),e.set(r,s+6),e.set(n,s+9);s.needsUpdate=!0}}set strokeWidth(e){const t=this.material;if(t.uniforms.strokeWidth.value!==e){t.uniforms.strokeWidth.value=e;const n=e>0;n!==t.defines.USE_STROKE&&(t.defines.USE_STROKE=n,t.needsUpdate=!0)}}get opacity(){return this.material.uniforms.opacity.value}set opacity(e){this.material.uniforms.opacity.value=e}onAdd(){this.livePropObject&&this.livePropName&&Object(l.a)(this.livePropObject,this.livePropName,this.updateText,!0)}onRemove(){Object(l.b)(this.settings,"fontFace",this.onFontFaceChange),this.livePropObject&&this.livePropName&&Object(l.b)(this.livePropObject,this.livePropName,this.updateText),this._fontFace&&(Object(l.b)(this._fontFace,"msdfTexture",this.onFontTextureUpdate),Object(l.b)(this._fontFace,"font",this.onFontUpdate))}setSize(e,t){}regenerateGeometry(){this.geometry&&this.geometry!==b&&Object(h.b)(()=>this.geometry.dispose()),this.geometry=v(this._text,this.settings,this._globalColor),this.updateMeasurements()}updateMeasurements(){this.geometry.boundingBox||this.geometry.computeBoundingBox();const e=this.geometry.boundingBox;this.width=e.max.x-e.min.x,this.height=Math.abs(e.max.y-e.min.y),this.userData.resolution=new i.Vector2(this.width,this.height),this.onMeasurementsUpdated&&this.onMeasurementsUpdated(this)}}const w=e=>{const t={msdf:new i.Uniform(e.fontFace.msdfTexture),alphaTest:new i.Uniform(e.alphaTest),strokeWidth:new i.Uniform(e.strokeWidth),strokeBias:new i.Uniform(e.strokeBias),strokeColor:new i.Uniform(new i.Color(e.strokeColor)),opacity:new i.Uniform(1)};e.screenSpace&&(t.offset=new i.Uniform(e.offset),t.clipSpacePosition=new i.Uniform(new i.Vector4),t.pixelSizeInClipSpace=o.b,t.prescale=new i.Uniform(e.prescale));const n=e.alphaTest>0&&e.alphaTest<1&&!e.shadow,r=new i.RawShaderMaterial({defines:{USE_STROKE:e.strokeWidth>0,USE_ALPHATEST:n,USE_SHADOW:e.shadow,USE_SCREENSPACE:e.screenSpace,CONSTANT_SIZE_ON_SCREEN:e.constantSizeOnScreen},uniforms:t,vertexShader:y(),fragmentShader:d(),transparent:!0,depthWrite:n,extensions:{derivatives:!0}});return Object.defineProperty(r,"opacity",{get:()=>r.uniforms.opacity.value,set:e=>r.uniforms.opacity.value=e}),r},b=new i.PlaneBufferGeometry(.001,.001);b.computeBoundingBox();const v=(e,t,n)=>t.fontFace.font&&e?S(e,t,n):b,S=(e,t,n)=>{const r=t.fontFace.font,o=(e=>Array.isArray(e)?e.reduce((e,t)=>e.concat(t.text),""):String(e))(e),h=s()({text:`${o}`,font:r,align:t.align,width:void 0!==t.width?t.width/t.size*r.info.size:void 0,lineHeight:void 0!==t.lineHeight?t.lineHeight*r.info.size:void 0,letterSpacing:t.letterSpacing}),l=h.getAttribute("position").array,u=l.length/2,d=x(n||t.color),f=Array.isArray(e)?e:[{text:o,color:d}],{base:p}=r.common,y=new Float32Array(3*u),g=new Float32Array(u);let m=0;f.forEach(e=>{const{topLeft:t,topRight:n,bottomLeft:i,bottomRight:s}=C(e.color),o=e.fontWeight||1,a=e.italicSkew||0,c=e.xOffset||0,h=e.yOffset||0,u=e.text.replace(/\s+/g,""),d=m,f=m+u.length;for(let e=d;e<f;e++){const d=12*e,f=4*e,w=2*f,b=u[e-m],v=r.chars.find(e=>String(e.char)===b);y.set(t,d+0),y.set(i,d+3),y.set(s,d+6),y.set(n,d+9),g[f+0]=o,g[f+1]=o,g[f+2]=o,g[f+3]=o;const S=p*a,_=v.height+v.yoffset-p,x=(p-v.yoffset)/p*S,C=_>0?_/p*-S:0;l[w+0]+=x,l[w+6]+=x,l[w+2]+=C,l[w+4]+=C,l[w+0]+=c,l[w+1]+=h,l[w+2]+=c,l[w+3]+=h,l[w+4]+=c,l[w+5]+=h,l[w+6]+=c,l[w+7]+=h}m=f}),h.setAttribute("color",new i.BufferAttribute(y,3)),h.setAttribute("weight",new i.BufferAttribute(g,1));const w=t.bakedOffset?t.bakedOffset.x:0,b=t.bakedOffset?t.bakedOffset.y:0;h.computeBoundingBox();const v=h.boundingBox;if(t.width){const e=h.layout.width;v.max.x=e-v.min.x}const S=v.min,_=v.max,M=h.attributes.position,B=M.itemSize,P=M.array;if("1"===e)for(let e=0;e<P.length;e+=B)P[e]-=2;const k=_.x-S.x,O=h.layout,T=(O._linesTotal-1)*O.lineHeight+O.capHeight,A=w+k*Object(a.a)(t.align)-S.x,F=b+T*Object(a.b)(t.vAlign);for(let e=0;e<P.length;e+=B)P[e]+=A,P[e+1]+=F;_.x+=A,S.x+=A,_.y+=F,S.y+=F;for(let e=1;e<P.length;e+=B)P[e]*=-1;S.y*=-1,_.y*=-1;let j=t.size/r.info.size;t.scaleDownToPhysicalSize&&(j/=c.a);for(let e=0;e<P.length;e++)P[e]*=j;if(S.multiplyScalar(j),_.multiplyScalar(j),S.y>_.y){const e=S.y;S.y=_.y,_.y=e}return h},_=e=>e instanceof i.Color?e:new i.Color(e),x=e=>e instanceof Gradient?e:new Gradient({top:e,bottom:e}),C=e=>({topLeft:(e=x(e||16777215)).topLeft.toArray(),topRight:e.topRight.toArray(),bottomLeft:e.bottomLeft.toArray(),bottomRight:e.bottomRight.toArray()})},function(e,t,n){"use strict";n.d(t,"a",function(){return TestLightingScene});var i=n(0),r=n(30),s=n(5),o=n(94),a=n(20);class TestLightingScene extends a.a{constructor(e=!0,t=!0){super();const n=Object(o.a)(this.scene,this.bgColor);this.sunLight=n.sunLight,this.ambientLight=n.ambientLight;const a=new r.a(this.camera);Object(s.b)("fpsCam")&&a.toggle(!0);(async()=>{const n=new i.MeshStandardMaterial({color:11197934,roughness:.7});if(t){const e=new i.Mesh(new i.PlaneBufferGeometry(1,1,1,1),n);e.scale.multiplyScalar(10),e.castShadow=!1,e.receiveShadow=!0,this.scene.add(e),e.rotation.x=-.5*Math.PI}if(e){const e=new i.Mesh(new i.SphereBufferGeometry(.3,32,16),n);e.castShadow=!0,e.receiveShadow=!0,e.position.x=-.3,e.position.y=.3,e.name="Sphere",this.scene.add(e);const t=new i.Mesh(new i.BoxBufferGeometry(.6,.6,.6),n);t.castShadow=!0,t.receiveShadow=!0,t.position.x=.3,t.position.y=.3,t.name="Cube",this.scene.add(t)}})()}}},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n(0);const r=new class MaterialLibrary{get keyboardPlasticKey(){return this._keyboardPlasticKey||(this._keyboardPlasticKey=new i.MeshStandardMaterial({color:15654314})),this._keyboardPlasticKey}get keyboardPlasticKeyMouth(){return this._keyboardPlasticKeyMouth||(this._keyboardPlasticKeyMouth=new i.MeshStandardMaterial({color:2232593,depthFunc:i.GreaterDepth,side:i.BackSide})),this._keyboardPlasticKeyMouth}get scoopMask(){return this._scoopMask||(this._scoopMask=new i.MeshBasicMaterial({color:16711935,depthWrite:!1,colorWrite:!1})),this._scoopMask}get keyboardPlasticKeyUnderside(){return this._keyboardPlasticKeyUnderside||(this._keyboardPlasticKeyUnderside=new i.MeshStandardMaterial({color:15654314,depthFunc:i.GreaterDepth,side:i.BackSide})),this._keyboardPlasticKeyUnderside}get keyboardPlastic(){return this._keyboardPlastic||(this._keyboardPlastic=new i.MeshStandardMaterial({color:11180441})),this._keyboardPlastic}get keyboardPlasticHole(){return this._keyboardPlasticHole||(this._keyboardPlasticHole=new i.MeshStandardMaterial({color:5588036,depthFunc:i.GreaterDepth,side:i.BackSide})),this._keyboardPlasticHole}get levelMaterial(){return this._levelMaterial||(this._levelMaterial=new i.MeshStandardMaterial({color:1122867})),this._levelMaterial}}},function(e,t,n){"use strict";n.d(t,"a",function(){return h});var i=n(54),r=n(18),s=n(78);const o={fontFace:r.a.GothicA1Regular,size:24,align:"center",vAlign:"center",letterSpacing:0,color:i.b,strokeWidth:0,strokeBias:1,alphaTest:0,strokeColor:i.a,scaleDownToPhysicalSize:!0,shadow:!1,screenSpace:!1,constantSizeOnScreen:!1,prescale:1},a={...o,...s.a.title,lineHeight:1.175,size:72,color:13815992,strokeWidth:.5,strokeBias:.5,strokeColor:2898505,fontFace:r.a.GothicA1ExtraBold},c={...o,lineHeight:1.175,size:24,color:i.a,fontFace:r.a.GothicA1Regular},h={generic:o,title:a,keyLabel:c,keyLabelDouble:{...c,lineHeight:1.2,fontFace:r.a.GothicA1Bold,size:14},keyLabelSmall:{...c,fontFace:r.a.GothicA1Bold,size:10},code:{...o,align:"left",fontFace:r.a.CourierPrimeRegular,size:32,lineHeight:3,color:39168}}},function(e,t,n){"use strict";n.d(t,"a",function(){return i});const i=new(n(83).a)(void 0,!1)},function(e,t,n){"use strict";n.d(t,"a",function(){return listenToProperty}),n.d(t,"b",function(){return stopListeningToProperty});var i=n(6);class LiveProperty{constructor(e,t){this.propName=t,this.listeners=[],this.setValue=this.setValue.bind(this),this.attach(e)}get listenerCount(){return this.listeners.length}attach(e){this.obj&&this.release(),this.obj=e;const t=this.obj[this.propName];Object.defineProperty(e,this.propName,{configurable:!0,set:this.setValue,get:()=>this.value}),this.setValue(t)}release(){Object.defineProperty(this.obj,this.propName,{value:this.value,writable:!0})}hasListener(e){return-1!==this.listeners.indexOf(e)}addListener(e,t=!0){t&&e(this.value,void 0),this.listeners.push(e)}removeListener(e){Object(i.e)(this.listeners,e)}setValue(e){if(this.value===e)return;const t=this.value;this.value=e;for(const n of this.listeners)n(e,t)}}const r=new Map;function getObjectPropGroup(e){return r.has(e)||r.set(e,new Map),r.get(e)}function listenToProperty(e,t,n,i=!0){(function getLiveProperty(e,t){const n=getObjectPropGroup(e);return n.has(t)||n.set(t,new LiveProperty(e,t)),n.get(t)})(e,t).addListener(n,i)}function stopListeningToProperty(e,t,n){const i=r.get(e);if(i){const s=i.get(t);s&&(s.removeListener(n),0===s.listenerCount&&(s.release(),i.delete(t))),0===i.size&&r.delete(e)}}},function(e,t,n){"use strict";n.d(t,"a",function(){return getBodyMeshEventManager});class BodyMeshEventManager{constructor(){this.bodiesToMeshes=new Map,this.createCallbacks=[],this.destroyCallbacks=[]}init(e){if(this.world)throw new Error("cannot initialize twice");this.world=e}createBody(e,t){for(const n of this.createCallbacks)n(e,t);this.bodiesToMeshes.set(e,t)}destroyBody(e){const t=this.bodiesToMeshes.get(e);this.bodiesToMeshes.delete(e);for(const n of this.destroyCallbacks)n(e,t);this.world.DestroyBody(e)}startListeningForCreate(e){for(const t of Array.from(this.bodiesToMeshes.keys()))e(t,this.bodiesToMeshes.get(t));this.createCallbacks.push(e)}startListeningForDestroy(e){this.destroyCallbacks.push(e)}}let i;function getBodyMeshEventManager(){return i||(i=new BodyMeshEventManager),i}},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n(0),r=n(59);function url(e,t){return`fonts/${e}.${t}`}class FontFace{constructor(e){this.name=e}async init(){this.initd||(this.initd=!0,this.msdfTexture=await Object(r.b)(url(this.name,"png")),this.msdfTexture.minFilter=i.LinearFilter,this.msdfTexture.magFilter=i.LinearFilter,this.font=await Object(r.a)(url(this.name,"json")))}}const s={CourierPrimeRegular:new FontFace("CourierPrime-Regular"),CourierPrimeBold:new FontFace("CourierPrime-Bold"),GothicA1Black:new FontFace("GothicA1-Black"),GothicA1Bold:new FontFace("GothicA1-Bold"),GothicA1ExtraBold:new FontFace("GothicA1-ExtraBold"),GothicA1ExtraLight:new FontFace("GothicA1-ExtraLight"),GothicA1Light:new FontFace("GothicA1-Light"),GothicA1Medium:new FontFace("GothicA1-Medium"),GothicA1Regular:new FontFace("GothicA1-Regular"),GothicA1SemiBold:new FontFace("GothicA1-SemiBold"),GothicA1Thin:new FontFace("GothicA1-Thin")}},function(e,t,n){"use strict";n.d(t,"a",function(){return i});const i={Linear:e=>e,Quadratic:{In:e=>e*e,Out:e=>e*(2-e),InOut:e=>(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)},Cubic:{In:e=>e*e*e,Out:e=>--e*e*e+1,InOut:e=>(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},Quartic:{In:e=>e*e*e*e,Out:e=>1- --e*e*e*e,InOut:e=>(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},Quintic:{In:e=>e*e*e*e*e,Out:e=>--e*e*e*e*e+1,InOut:e=>(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},Sinusoidal:{In:e=>1-Math.cos(e*Math.PI/2),Out:e=>Math.sin(e*Math.PI/2),InOut:e=>.5*(1-Math.cos(Math.PI*e))},Exponential:{In:e=>0===e?0:Math.pow(1024,e-1),Out:e=>1===e?1:1-Math.pow(2,-10*e),InOut:e=>0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))},Circular:{In:e=>1-Math.sqrt(1-e*e),Out:e=>Math.sqrt(1- --e*e),InOut:e=>(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},Elastic:{In(e){let t,n=.1;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=.1):t=.4*Math.asin(1/n)/(2*Math.PI),-n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4))},Out(e){let t,n=.1;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=.1):t=.4*Math.asin(1/n)/(2*Math.PI),n*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/.4)+1)},InOut(e){let t,n=.1;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=.1):t=.4*Math.asin(1/n)/(2*Math.PI),(e*=2)<1?n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4)*-.5:n*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4)*.5+1)}},Back:{In(e){const t=1.70158;return e*e*((t+1)*e-t)},Out(e){const t=1.70158;return--e*e*((t+1)*e+t)+1},InOut(e){const t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:e=>1-i.Bounce.Out(1-e),Out:e=>e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375,InOut:e=>e<.5?.5*i.Bounce.In(2*e):.5*i.Bounce.Out(2*e-1)+.5}}},function(e,t,n){"use strict";n.d(t,"a",function(){return BaseTestScene});var i=n(0),r=n(2),s=n(5);const o=35,a=28;class BaseTestScene{constructor(){this.autoClear=!0;const e=new i.Scene,t=Object(s.a)("bgColor",new i.Color(11522047));e.fog=new i.Fog(t.getHex(),0,60),e.autoUpdate=!1,e.matrixAutoUpdate=!1;const n=new i.PerspectiveCamera(r.a.isMobile?a:o,r.a.aspect,.1,100);r.a.onChange(()=>{n.fov=r.a.isMobile?a:o,n.aspect=r.a.aspect,n.updateProjectionMatrix()},!0),n.position.set(0,3,3),n.lookAt(0,0,0),n.updateProjectionMatrix(),e.add(n),this.scene=e,this.camera=n,this.bgColor=t}update(e){this.scene.updateMatrixWorld(!1)}render(e,t){this.autoClear&&(e.setClearColor(this.bgColor,1),e.clear(!0,!0,!0)),e.render(this.scene,this.camera)}}},function(e,t,n){"use strict";n.d(t,"b",function(){return getChamferedBoxGeometry}),n.d(t,"a",function(){return getCachedChamferedBoxGeometry});var i=n(0),r=n(4);function getChamferedBoxGeometry(e,t,n,s=.005){const o=new i.SphereBufferGeometry(.02,8,5,.125*Math.PI),a=o.attributes.position.array,c=o.attributes.normal.array,h=new i.Vector3,l=new i.Vector3,u=.5*e-s,d=.5*t-s,f=.5*n-s;for(let e=0;e<c.length;e+=3)h.fromArray(c,e),l.fromArray(a,e),h.round(),1===h.y&&h.set(0,1,0),-1===h.y&&h.set(0,-1,0),h.toArray(c,e),h.multiplyScalar(s),h.x+=u*Object(r.d)(l.x),h.y+=d*Object(r.d)(l.y),h.z+=f*Object(r.d)(l.z),h.toArray(a,e);return o}const s=new Map;function getCachedChamferedBoxGeometry(e,t,n,i=.005){const r=`${e};${t};${n};${i};`;return s.has(r)||s.set(r,getChamferedBoxGeometry(e,t,n,i)),s.get(r)}},function(e,t,n){"use strict";n.d(t,"c",function(){return s}),n.d(t,"a",function(){return o}),n.d(t,"b",function(){return a});var i=n(0),r=n(2);const s=new i.Uniform(0),o=new i.Uniform(r.a.pixelRatio),a=new i.Uniform(new i.Vector2(2/r.a.width,2/r.a.height))},,,function(e,t,n){"use strict";n.d(t,"a",function(){return c});var i=n(0),r=n(7),s=n(2),o=n(22),a=n(81);const c=document.createElement("canvas");c.oncontextmenu=e=>{e.preventDefault(),e.stopPropagation()};const h=new i.WebGLRenderer({canvas:c,antialias:!0,premultipliedAlpha:!1});document.body.append(c);["-moz-crisp-edges","-webkit-crisp-edges","pixelated","crisp-edges"].forEach(e=>{h.getContext().canvas.style.setProperty("image-rendering",e)}),h.shadowMap.enabled=!0,h.shadowMap.type=i.PCFShadowMap,h.autoClear=!1;const l=new a.a("pixel-down-sample-3","Graphics Quality",0,0,10,e=>e,e=>e+"",!0,r.b,1);let u=1;function updatePixelRatio(){const e=s.a.pixelRatio/u;o.a.value=e,h.setPixelRatio(e)}l.listen(e=>{u=Math.round(e+1),updatePixelRatio()}),s.a.onChange(()=>{updatePixelRatio();const{width:e,height:t}=s.a;h.setSize(e,t),o.a.value=s.a.pixelRatio,o.b.value.set(2/e,2/t)},!0);Math.min(8192,h.capabilities.maxTextureSize);t.b=h},,,function(e,t,n){"use strict";n.d(t,"a",function(){return getKeyboardInput});var i=n(70);let r;function getKeyboardInput(e=!0){return r||(r=new i.a(e)),r}},,function(e,t,n){"use strict";n.d(t,"a",function(){return FPSControls});var i=n(0),r=n(91),s=n.n(r),o=n(25),a=n(32),c=n(5),h=n(4),l=n(48);const u=Object(c.c)("camDamping",0,0,.999),d=1-Object(h.b)(u,0,1);class FPSControls{constructor(e){this._camera=e,this._active=!1,this._fpsController=void 0}toggle(e){void 0===e&&(e=!this._active),this._fpsController||(this._cameraLocal=new i.PerspectiveCamera,function copyCam(e,t){e.position.copy(t.position),e.scale.copy(t.scale),e.quaternion.copy(t.quaternion),e.fov=t.fov}(this._cameraLocal,this._camera),this._camera.parent.add(this._cameraLocal),this._fpsController=new s.a(this._cameraLocal,o.b.domElement,{movementSpeed:.01}),l.a.register(this));const t=this._fpsController.onPointerLockAttainSignal,n=t._bindings[0]._listener;t._bindings[0]._listener=()=>{this._active&&n()},e||this._fpsController.onPointerLockReleaseSignal.dispatch(),this._active=e}update(){this._active&&this._fpsController&&(this._fpsController.update(),this._camera.position.lerp(this._cameraLocal.position,d),this._camera.quaternion.slerp(this._cameraLocal.quaternion,d),this._camera.scale.lerp(this._cameraLocal.scale,d),this._camera.fov=Object(h.e)(this._camera.fov,this._cameraLocal.fov,d),a.a.updateProjection())}}new FPSControls(a.a.camera)},function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n(15),r=n(6);class TimedTask{constructor(e,t){this.expireTime=e,this._task=t}task(){this._task?(this._task(),this._task=void 0):console.warn("timed task asked to fire twice??")}}const s=new class Timer{constructor(){this.time=0,this.tasks=[]}update(e){for(this.time+=e;this.tasks.length>0&&this.tasks[0].expireTime<=this.time;)this.tasks.shift().task()}add(e,t,n=!1){n&&(t*=i.a.speed);const r=new TimedTask(this.time+t,e);return this.tasks.push(r),this.tasks.sort((e,t)=>e.expireTime-t.expireTime),r}runPrematurely(e){e.task(),Object(r.e)(this.tasks,e)}cancel(e){Object(r.e)(this.tasks,e)}}},function(e,t,n){"use strict";n.d(t,"a",function(){return l});var i=n(0),r=n(2),s=n(4);const o=.1,a=200,c=6e3;const h=new i.PerspectiveCamera(r.a.isMobile?28:35,r.a.aspect,.01,10),l=new class CameraShaker{constructor(e){this.camera=e,this._time=0,this._timers=[],this._shakeScale=25e-5,this._shakeStrength=0;const t=e.clone();t.position.set(0,0,0),t.quaternion.setFromEuler(new i.Euler(0,0,0)),t.scale.set(1,1,1),e.add(t),this.shakyCamera=t}set shakeStrength(e){(e=Object(s.b)(e,0,1))!==this._shakeStrength&&(this._shakeStrength=e)}set shakeScale(e){(e=Object(s.b)(e,0,10))!==this._shakeScale&&(this._shakeScale=e)}updateProjection(){this.shakyCamera.fov=this.camera.fov,this.shakyCamera.aspect=this.camera.aspect,this.shakyCamera.updateProjectionMatrix()}update(e){if(this._time+=e,this.shakeStrength=this._shakeStrength+e/o*(this._timers.length>0?12:-1),this._shakeStrength>0){this.shakyCamera.position.set(0,0,0);let e=1;for(let t=a;t<c;t*=1.674,e*=.8){const n=1/e*this._shakeScale*this._shakeStrength;this.shakyCamera.position.x+=Math.sin(this._time*t)*n,this.shakyCamera.position.y+=Math.sin(this._time*t*1.235)*n,this.shakyCamera.position.z+=Math.sin(this._time*t*1.67235)*n}}for(;this._timers.length>0&&this._timers[0]<=this._time;)this._timers.shift()}add(e){this._timers.push(this._time+e),this._timers.sort()}}(h);r.a.onChange(()=>{h.fov=r.a.isMobile?28:35,h.aspect=r.a.aspect,h.updateProjectionMatrix(),l.updateProjection()})},,,function(e,t,n){"use strict";n.d(t,"b",function(){return queueDestruction}),n.d(t,"a",function(){return processDestructions});var i=n(10),r=n(17);const s=[];function queueDestruction(e){s.push(e)}function processDestructions(){if(s.length>0){for(const e of s)destructBody(e);s.length=0}}function destructBody(e){const t=e.GetBody();try{Object(i.a)().destroyBody(t),Object(r.a)().destroyBody(t)}catch(e){console.log(e)}}},function(e,t,n){"use strict";n.d(t,"a",function(){return getArchitecturePiece});var i=n(4);const r={column1:2,column2:2,column3:2,column4:2,column5:1,vase:2},s=Object.keys(r);function getArchitecturePiece(e=s[Object(i.h)(s.length)],t="collider"+Object(i.h)(r[e],1)){return{meshName:e,colliderName:t}}},,,function(e,t,n){"use strict";n.d(t,"a",function(){return Testb2World});var i=n(1),r=n(0),s=n(2),o=n(28),a=n(8),c=n(74),h=n(10),l=n(17),u=n(35),d=n(44),f=n(3),p=n(80),y=n(5),g=n(4),m=n(31),w=n(86),b=n(87),v=n(36);const S=35,_=28;let x=!1,C=!1,M=!1,B=!1,P=!1;class Testb2World{constructor(e,t,n){this.rayCastConverter=e,this.nextLevelCallback=t,this.gameResetCallback=n,this.debugMode=Object(y.b)("debugMode"),this.autoClear=!0,this.gui=new p.a,this.player=new Player,this.activeArchitectureBodies=[],this.inactiveArchitectureBodies=[],this.isStarted=!1,this.isTimerOver=!1,this.stateUpdates={uninitialized:e=>{},waitingForInput:e=>{this.noInteract=!1,0===this.player.currentHealth&&(this.gameOver(),this.state="gameOver")},playing:e=>{if(this.player.currentTimer-=e,this.selectedBody){const e=this.cursorPosition.Clone();e.SelfSub(this.selectedBodyOffset),this.selectedBody.SetPosition(e)}if(!this.selectedBody&&this.lastSelectedBody&&this.isTurningBody&&this.initialRotationHandlePosition){const e=this.lastSelectedBody.GetPosition().Clone();e.SelfSub(this.initialRotationHandlePosition);const t=Math.atan2(e.y,e.x),n=this.lastSelectedBody.GetPosition().Clone();n.SelfSub(this.cursorPosition);const i=Math.atan2(n.y,n.x);let r=Object(g.j)(i-t,-Math.PI,Math.PI);const s=n.Length(),o=.5;s<o&&(r*=Object(g.i)(.05,o,s)),this.lastSelectedBody.SetAngularVelocity(.001);const a=this.lastSelectedBody.GetAngle();this.lastSelectedBody.SetAngle(r+a),this.initialRotationHandlePosition.Copy(this.cursorPosition)}this.player.currentTimer<0?(this.player.currentTimer=0,this.noInteract=!0,this.selectedBody=void 0,this.lastSelectedBody=void 0,this.turnGravityOn(this.b2World,this.applyCurrentAtmosphericDamping),m.a.add(()=>{this.state="checking"},5),this.state="settling"):0===this.player.currentHealth&&(this.gameOver(),this.state="gameOver")},settling:e=>{},checking:e=>{let t=this.goalLine.m_contactList,n=!1;for(;t;){if(t.contact.IsTouching()){n=!0;break}t=t.next}0===this.player.currentHealth&&(n=!1),n?(this.activeArchitectureBodies.forEach(e=>{let t=e.GetFixtureList();for(;t;){const e=Object(f.l)(["environment"]);t.m_filter.categoryBits=e,t=t.m_next}}),console.log("Congrats, you passed the level!"),this.nextLevelCallback&&this.nextLevelCallback(),this.player.currentLevel+=1,this.b2Preview.offset.y=this.player.currentLevel,this.turnGravityOff(this.b2World,this.applyCurrentAtmosphericDamping),m.a.add(()=>{this.pieceSpawnPoints5.forEach(e=>{const{meshName:t,colliderName:n}=Object(v.a)();Object(f.b)({x:e.x,y:e.y+this.b2Preview.offset.y,angle:0,meshName:t,colliderName:n,categoryArray:["architecture"],maskArray:["penalty","environment","architecture","goal"]}).then(e=>{this.applyCurrentAtmosphericDamping(e.body),this.activeArchitectureBodies.push(e.body)})}),this.goalLine.SetPosition(new i.Vec2(0,1*this.player.currentLevel-.25)),this.penaltyLine.SetPosition(new i.Vec2(0,1*this.player.currentLevel-1.5)),this.player.currentTimer=20+10*this.player.currentLevel,this.player.maxTimer=20+10*this.player.currentLevel,this.state="waitingForInput"},2),this.state="transitioning"):(this.gameOver(),this.state="gameOver")},transitioning:e=>{},gameOver:e=>{}},this.pieceSpawnPoints5=[new i.Vec2(-1.55,-.35),new i.Vec2(-.95,.65),new i.Vec2(0,1),new i.Vec2(.95,.65),new i.Vec2(1.55,-.35)],this.pieceSpawnPoints9=[new i.Vec2(-1.55,-.35),new i.Vec2(-1.35,.3),new i.Vec2(-.95,.65),new i.Vec2(-.45,.85),new i.Vec2(0,1),new i.Vec2(.45,.85),new i.Vec2(.95,.65),new i.Vec2(1.35,.3),new i.Vec2(1.55,-.35)],this.readyForLevelStart=!0,this._state="uninitialized",this._postUpdates=[],this.applyCurrentAtmosphericDamping=e=>{e.SetLinearDamping(this.currentLinearDamping),e.SetAngularDamping(this.currentAngularDamping)},this.initiateScene();const r=new i.World(new i.Vec2(0,0));Object(h.a)().init(r),Object(l.a)().init(r);const s=new a.a(r);this.b2Preview=s,this.b2Preview&&!e&&(this.rayCastConverter=f.a.bind(null,this.b2Preview)),this.scene.add(this.b2Preview),a.b.value=!0,this.b2World=r;const u=Object(b.a)(),d=new c.a;d.listenForHealthChanges(e=>{this.player.currentHealth=Math.max(0,this.player.currentHealth+e)}),u.register(d),this.b2World.SetContactListener(u),Object(o.a)().addListener(this.HandleKey),this._postUpdates.push(Object(w.a)(this.b2World,e,this.gui,this.b2Preview,this.player)),Object(f.g)(this.b2World,0,-1,2,.1),Object(f.g)(this.b2World,-1,-.9,.2,.1),Object(f.g)(this.b2World,1,-.9,.2,.1),this.penaltyLine=Object(f.f)(this.b2World,0,-1.5,10,.1,["penalty"],["architecture"]),this.goalLine=Object(f.f)(this.b2World,0,-.25,10,.1,["goal"],["architecture","environment"]),this.currentLinearDamping=5,this.currentAngularDamping=5,this.pieceSpawnPoints5.forEach(e=>{const{meshName:t,colliderName:n}=Object(v.a)();Object(f.b)({x:e.x,y:e.y,angle:0,meshName:t,colliderName:n,categoryArray:["architecture"],maskArray:["penalty","environment","architecture","goal"]}).then(e=>{this.applyCurrentAtmosphericDamping(e.body),this.activeArchitectureBodies.push(e.body)})});document.addEventListener("mousedown",e=>{if(!this.gui.rayCastForButton(e.clientX,e.clientY)){"waitingForInput"===this.state&&(this.state="playing"),this.cursorPosition=this.rayCastConverter(e.clientX,e.clientY);const t=this.rayCastConverter(e.x,e.y);if(!this.noInteract){if(this.selectedBody=Object(f.m)(r,t),this.selectedBody){const e=t.Clone().SelfSub(this.selectedBody.GetPosition());this.selectedBodyOffset=e}this.selectedBody?this.lastSelectedBody=this.selectedBody:!this.selectedBody&&this.lastSelectedBody&&(this.lastSelectedBodyAngle=this.lastSelectedBody.GetAngle(),this.initialRotationHandlePosition=t,this.isTurningBody=!0)}if(this.debugMode){if(x){const{meshName:e,colliderName:n}=Object(v.a)();Object(f.b)({x:t.x,y:t.y,angle:0,meshName:e,colliderName:n,categoryArray:["architecture"],maskArray:["penalty","environment","architecture","goal"]}).then(e=>{this.applyCurrentAtmosphericDamping(e.body),this.activeArchitectureBodies.push(e.body)})}if(C){const e=Object(f.c)(r,t.x,t.y,.2,["architecture"],["penalty","environment","architecture","goal"],this.player);this.applyCurrentAtmosphericDamping(e),this.activeArchitectureBodies.push(e)}M&&this.turnGravityOn(r,this.applyCurrentAtmosphericDamping),B&&this.turnGravityOff(r,this.applyCurrentAtmosphericDamping)}}},!1),document.addEventListener("mouseup",e=>{this.selectedBody=void 0,this.initialRotationHandlePosition=void 0,this.isTurningBody=!1,this.lastSelectedBody&&this.lastSelectedBody.SetAngularVelocity(0)},!1),document.addEventListener("mousemove",e=>{this.cursorPosition=this.rayCastConverter(e.clientX,e.clientY),this.selectedBody&&this.selectedBody.SetLinearVelocity(new i.Vec2(1e-4,0))},!1),this.state="waitingForInput"}get state(){return this._state}set state(e){this.state!==e&&(console.log(e),this._state=e,this.stateUpdate=this.stateUpdates[e])}HandleKey(e,t){switch(e){case"KeyQ":x=t;break;case"KeyZ":C=t;break;case"KeyX":M=t;break;case"KeyC":B=t;break;case"KeyV":P=t}}update(e){this.scene.updateMatrixWorld(!1),this.b2World.Step(e,10,4);for(const t of this._postUpdates)t(e);this.b2Preview&&this.b2Preview.update(e),Object(u.a)(),Object(d.a)(e,this.player),this.stateUpdate(e)}render(e,t){this.autoClear&&(e.setClearColor(this.bgColor,1),e.clear(!0,!0,!0)),e.render(this.scene,this.camera),this.gui.render(e)}gameOver(){console.log("Sorry, you lost!"),this.isStarted=!1,this.player.currentLevel=0,this.b2Preview.offset.y=this.player.currentLevel,this.selectedBody=void 0,this.lastSelectedBody=void 0,this.gameResetCallback&&this.gameResetCallback(),this.activeArchitectureBodies.forEach(e=>{const t=e.GetFixtureList();t&&Object(u.b)(t)}),this.activeArchitectureBodies.length=0,this.turnGravityOff(this.b2World,this.applyCurrentAtmosphericDamping),m.a.add(()=>{this.pieceSpawnPoints5.forEach(e=>{const{meshName:t,colliderName:n}=Object(v.a)();Object(f.b)({x:e.x,y:e.y+this.b2Preview.offset.y,angle:0,meshName:t,colliderName:n,categoryArray:["architecture"],maskArray:["penalty","environment","architecture","goal"]}).then(e=>{this.applyCurrentAtmosphericDamping(e.body),this.activeArchitectureBodies.push(e.body)})}),this.goalLine.SetPosition(new i.Vec2(0,1*this.player.currentLevel-.25)),this.penaltyLine.SetPosition(new i.Vec2(0,1*this.player.currentLevel-1.5)),this.player.currentTimer=20+10*this.player.currentLevel,this.player.maxTimer=20+10*this.player.currentLevel,this.player.currentHealth=5,this.state="waitingForInput"},2)}turnGravityOff(e,t){e.SetGravity(new i.Vec2(0,0)),this.currentLinearDamping=5,this.currentAngularDamping=5,this.activeArchitectureBodies.forEach(t)}turnGravityOn(e,t){e.SetGravity(new i.Vec2(0,-9.8)),this.currentLinearDamping=0,this.currentAngularDamping=0,this.activeArchitectureBodies.forEach(t)}initiateScene(){const e=new r.Scene,t=Object(y.a)("bgColor",new r.Color(2301728));e.fog=new r.Fog(t.getHex(),0,160),e.autoUpdate=!1,e.matrixAutoUpdate=!1;const n=new r.PerspectiveCamera(s.a.isMobile?_:S,s.a.aspect,.1,100);s.a.onChange(()=>{n.fov=s.a.isMobile?_:S,n.aspect=s.a.aspect,n.updateProjectionMatrix()},!0),n.position.set(0,0,0),n.lookAt(0,0,0),n.updateProjectionMatrix(),e.add(n),this.scene=e,this.camera=n,this.bgColor=t}}class Player{constructor(){this.currentHealth=5,this.maxHealth=5,this.currentLevel=0,this.currentTimer=20,this.maxTimer=20}}},function(e,t,n){"use strict";n.d(t,"a",function(){return hexColor});var i=n(0);n(4);new i.Color(1,1,1),new i.Color;function hexColor(e){const t=/^\#([A-Fa-f0-9]+)$/.exec(e);if(t){const e=t[1],n=e.length;if(3===n){const t=new i.Color;return t.r=parseInt(e.charAt(0)+e.charAt(0),16)/255,t.g=parseInt(e.charAt(1)+e.charAt(1),16)/255,t.b=parseInt(e.charAt(2)+e.charAt(2),16)/255,t}if(6===n){const t=new i.Color;return t.r=parseInt(e.charAt(0)+e.charAt(1),16)/255,t.g=parseInt(e.charAt(2)+e.charAt(3),16)/255,t.b=parseInt(e.charAt(4)+e.charAt(5),16)/255,t}}return new i.Color(1,0,1)}},function(e,t,n){"use strict";n.d(t,"a",function(){return getArchitectMeshAndFixtures});var i=n(1),r=n(0),s=n(42),o=n(7),a=n(43),c=n(3);async function getArchitectMeshAndFixtures(e,t,n="collider",h,l){const u=await s.a.requestMesh({body:e,meshName:t,colliderName:n,addPivot:!0,categoryArray:h,maskArray:l}),d=Object(a.a)(u,n),f=d.geometry.attributes.position,p=d.geometry.getIndex(),y=new i.FixtureDef;if(h&&l&&(y.filter.categoryBits=Object(c.l)(h),y.filter.maskBits=Object(c.l)(l)),y.density=1,f instanceof r.BufferAttribute&&p instanceof r.BufferAttribute){const t=f.array,n=p.array,r=new i.PolygonShape,s=new Set;y.shape=r;for(let e=0;e<n.length;e+=3){const t=n[e],i=n[e+1],r=n[e+2],o=t+":"+i,a=i+":"+r,c=r+":"+t,h=t+":"+r,l=i+":"+t,u=r+":"+i;s.has(l)?s.delete(l):s.add(o),s.has(u)?s.delete(u):s.add(a),s.has(h)?s.delete(h):s.add(c)}const a=new Map;for(const e of s){const t=e.split(":").map(e=>parseInt(e,10));a.set(t[0],t[1])}const c=[];for(;a.size>0;){const e=a.keys().next().value;let t=a.get(e);const n=[t];a.delete(e);do{const e=a.get(t);a.delete(t),n.push(e),t=e}while(t!==e);c.push(n)}for(const n of c){const s=n.map(e=>{const n=3*e;return new i.Vec2(t[n]*o.a,t[n+2]*-o.a)});r.Set(s),e.CreateFixture(y)}}return u}},function(e,t,n){"use strict";n.d(t,"a",function(){return c});var i=n(0),r=n(29),s=n(43),o=n(7),a=n(75);class QueuedParams{constructor(e,t){this.params=e,this.resolve=t}}const c=new class ArchitectureModelFactory{constructor(){this._status="not started",this._bodiesPromisedMeshes=new Map,this._bodyMeshMap=new Map}async requestMesh(e){return new Promise(t=>{"ready"===this._status?t(this._makeMesh(e)):(this._bodiesPromisedMeshes.set(e.body,new QueuedParams(e,t)),"not started"===this._status&&this._init())})}deleteMesh(e){if(this._bodiesPromisedMeshes.has(e)&&this._bodiesPromisedMeshes.delete(e),this._bodyMeshMap.has(e)){const t=this._bodyMeshMap.get(e);return this._bodyMeshMap.delete(e),t}}async _init(){if("not started"!==this._status)throw new Error("cannot initialize twice");{this._status="initializing";const e=new r.a,t=await e.loadAsync("game/models/architecture.glb");this._gltf=t;for(const e of t.scene.children)e.traverse(e=>{e instanceof i.Mesh&&(e.name.includes("collider")?e.visible=!1:(e.castShadow=!0,e.receiveShadow=!0))});this._status="ready",this._bodiesPromisedMeshes.forEach((e,t)=>{e.resolve(this._makeMesh(e.params))})}}_makeMesh(e){const t=Object(a.a)(this._gltf,e.meshName),n=e.body.GetPosition();if(t.position.set(n.x,-n.y,0),e.addPivot){const n=new i.Object3D;n.add(t);const r=Object(s.a)(t,e.colliderName);for(let e=t.children.length;e>=0;e--){const n=t.children[e];n!==r&&t.remove(n)}return r.updateMatrix(),r.matrix.clone().invert().decompose(t.position,t.quaternion,t.scale),n.rotateX(.5*Math.PI),n.scale.multiplyScalar(o.a),this._bodyMeshMap.set(e.body,n),n}return t.scale.multiplyScalar(o.a),this._bodyMeshMap.set(e.body,t),t}}},function(e,t,n){"use strict";n.d(t,"a",function(){return findCollider});var i=n(0);function findCollider(e,t){let n;if(e.traverse(e=>{e instanceof i.Mesh&&e.name.includes(t)&&(n=e)}),!n)throw new Error("no collider found");return n}},function(e,t,n){"use strict";n.d(t,"b",function(){return registerHUD}),n.d(t,"a",function(){return processHUD});var i=n(0),r=n(11);let s;const o=new Map,a=new Map,c=40;async function registerHUD(e,t){s=t,await async function initializeHealthHUD(e){const t=[];for(let n=0;n<e.maxHealth;n++){const e=await s.makeWhiteHeartIcon(s._narrowerWindowDimension/c*.5+(n+1)*c,1.25*c);e.material.color.set(new i.Color(1.2,0,0)),t.push(e)}o.set(e,t)}(e),await async function initializeFullscreenButton(){return s.makeFullscreenIcon(s._relativeWidthButtonSpacing,window.innerHeight-s._relativeHeightButtonSpacing/2)}();const n=s.makeTimerBar(0,0);a.set(e,n);const h=new r.a(`${e.currentTimer}`);h.scale.multiplyScalar(100),h.opacity=2,n.add(h);const l=new r.a(`Level: ${e.currentLevel+1}`);l.scale.multiplyScalar(100),l.opacity=2,n.add(l)}function processHUD(e,t){!function healthHUDupdate(e){const t=o.get(e);if(!t)return;let n=0;for(const r of t)n>=e.currentHealth?r.material.color.set(16777215):r.material.color.set(new i.Color(1.2,0,0)),r.position.set(s._narrowerWindowDimension/c*.5+(n+1)*c,1.25*c,0),n++}(t);const n=window.innerWidth/3,r=a.get(t);if(!r)return;const h=t.currentTimer/t.maxTimer*4;r.scale.x=100*h,r.position.set(n+r.scale.x/2,2*s._relativeHeightButtonSpacing/4,0),r.children[0].scale.x=4e3/r.scale.x;r.children[0].position.set((h-1)/h/2-1,.05,0);const l=r.children[1];l.scale.x=4e3/r.scale.x,l.position.set((h+4)/h/2-1,.05,0),l.text=`${t.currentTimer.toFixed(2)}`;const u=r.children[2];u.scale.x=4e3/r.scale.x,u.position.set((h+4)/h/2-1,1.05,0),u.text=`Level: ${t.currentLevel+1}`}},function(e,t,n){"use strict";n.d(t,"a",function(){return i});const i=1/.0254*72},function(e,t,n){"use strict";n.d(t,"a",function(){return nextFrameUpdate}),n.d(t,"b",function(){return onNextFrame});const i=[];function nextFrameUpdate(){i.length>0&&(i.forEach(e=>e()),i.length=0)}function onNextFrame(e){i.push(e)}},function(e,t,n){"use strict";n.d(t,"a",function(){return TestTextPhysicsScene}),n.d(t,"b",function(){return runTextPhysicsTest});var i=n(10),r=n(3),s=n(18),o=n(11),a=n(14),c=n(30),h=n(5),l=n(9);class TestTextPhysicsScene extends l.a{constructor(){super();const e=new c.a(this.camera);Object(h.b)("fpsCam")&&e.toggle(!0);const t=runTextPhysicsTest(this.scene,this.b2World);setTimeout(()=>{t.settings.fontFace=s.a.GothicA1Black},2e3);(async()=>{})()}update(e){super.update(e)}render(e,t){super.render(e,t)}}function runTextPhysicsTest(e,t){let n;const s=new o.a(["/**","* For the brave souls who get this far: You are the chosen ones,","* the valiant knights of programming who toil away, without rest,","* testCode.scale.multiplyScalar(s)","* testCode.position.z -= 6","* testCode.position.x -= 2","* scene.add(testCode)","* ","* testCode.onMeasurementsUpdated = () => {","*                                            if (lastKnownTextBodies) {","*                                                                                 for (const body of lastKnownTextBodies) {","* }","* lastKnownTextBodies = undefined","* }","* lastKnownTextBodies = textToPhysicsBodies(testCode, b2World)","* }","* return testCode","*/"].join("\n"),a.a.code,void 0,void 0);return s.scale.multiplyScalar(10),s.position.z-=6,s.position.x-=2,e.add(s),s.onMeasurementsUpdated=()=>{if(n){for(const e of n)Object(i.a)().destroyBody(e);n=void 0}n=Object(r.n)(s,t)},s}},function(e,t,n){"use strict";var i=n(6);const r=[],s={update:e=>{for(const t of r)t.update(e)},register:e=>{r.push(e)},unregister:e=>{Object(i.e)(r,e)}};t.a=s},function(e,t,n){"use strict";n.d(t,"a",function(){return TestGraphicsLevelScene});var i=n(1),r=n(0),s=n(28),o=n(13),a=n(8),c=n(3),h=n(50),l=n(7),u=n(21),d=n(5),f=n(51),p=n(12);class TestGraphicsLevelScene extends p.a{constructor(e="test-layout"){super(!1,!1),this.checkpointBodies=[];const t=new i.World(new i.Vec2(0,-9.8));if(this.b2World=t,Object(d.b)("debugPhysics")){const e=new a.a(t);this.b2Preview=e,this.scene.add(e)}new h.a(Object(d.e)("level")||e,(e,n,i,s,a)=>{const h=16776960===a;Object(c.d)(t,e,n,i,s,h);const d=.5*(i+s);n+s>=32&&(s+=100);const f=o.a.levelMaterial.clone();f.color.setHex(a);const p=new r.Mesh(Object(u.a)(i*l.c,s*l.c,d*l.c,.01),f);p.receiveShadow=!0,p.castShadow=!0,p.position.set((e-.5*i)*l.c-.8,.4-(n+.5*s)*l.c,0),this.scene.add(p);const y=(.5*d+1)*l.c;if(16776960===a){const e=p.clone();e.position.z-=y,p.position.z+=y,this.scene.add(e)}},()=>{const e=new f.a,t=Object(s.a)();t.addListener(e.onKeyCodeEvent),e.scale.multiplyScalar(5),e.position.set(-0,0,-.5),this.scene.add(e),this.keyboardInput=t,this.keyboardMesh=e})}update(e){super.update(e),this.b2World.Step(e,10,4),this.b2Preview&&this.b2Preview.update(e)}}},function(e,t,n){"use strict";n.d(t,"a",function(){return PNGLevel});var i=n(0);class BlocksRecipes{constructor(){this.blocks=new Map}register(e,t,n,i,r){this.blocks.has(e)||this.blocks.set(e,new Map);const s=this.blocks.get(e);s.has(r)||s.set(r,new Map);const o=s.get(r);o.has(n)||o.set(n,new Map);const a=o.get(n);let c=!1;for(const[e,n]of a.entries())e+n===t&&(a.set(e,n+1),c=!0);c||a.set(t,i)}process(e){this.blocks.forEach((t,n)=>{t.forEach((t,i)=>{t.forEach((t,r)=>{t.forEach((t,s)=>{e(n,s,r,t,i)})})})})}}class PNGLevel{constructor(e,t,n,r){const s=new Image;s.crossOrigin="Anonymous",s.onload=e=>{const r=new BlocksRecipes,o=document.createElement("canvas"),a=s.width,c=s.height;o.width=a,o.height=c;const h=o.getContext("2d");h.drawImage(s,0,0,a,c);const l=h.getImageData(0,0,a,c).data;let u=0;const d=new i.Color,f=new i.Color;function extractColour(e,t){e.r=l[4*t+0]/255,e.g=l[4*t+1]/255,e.b=l[4*t+2]/255}const p=a*c;for(let e=0;e<p;e++){extractColour(d,e);const t=l[4*e+3]>128,n=e+1;extractColour(f,n);const i=l[4*n+3]>128;let s=!1;if(t?(u++,d.equals(f)||(s=!0),t!==i&&(s=!0)):s=!0,n%a==0&&(s=!0),s&&u>0){const t=e%a,n=Math.floor(e/a);r.register(t,n,u,1,d.getHex()),u=0}}r.process(t),n&&n()},s.onerror=e=>{console.error("image not found: "+e)},s.src=`game/levels/${e}.png`}}},function(e,t,n){"use strict";n.d(t,"a",function(){return ProceduralKeyboardMesh});var i=n(0),r=n(13),s=n(21),o=n(97),a=n(52);const c=.015;class KeyInfo{constructor(e,t,n){this.label=e,this.width=t,this.eventCode=n,this.width*=c}}class KeySpace extends KeyInfo{constructor(e){super("",e,void 0)}}const h=[[new KeyInfo("ESC",1,"Escape"),new KeySpace(2),new KeyInfo("F1",1,"F1"),new KeyInfo("F2",1,"F2"),new KeyInfo("F3",1,"F3"),new KeyInfo("F4",1,"F4"),new KeyInfo("F5",1,"F5"),new KeyInfo("F6",1,"F6"),new KeyInfo("F7",1,"F7"),new KeyInfo("F8",1,"F8"),new KeyInfo("F9",1,"F9"),new KeyInfo("F10",1,"F10"),new KeyInfo("F11",1,"F11"),new KeyInfo("F12",1,"F12"),new KeySpace(.5),new KeyInfo("PRNT SCRN",1,"F13"),new KeyInfo("SCR LK",1,"F14"),new KeyInfo("PAUSE",1,"F15")],[new KeyInfo("~",1,"Backquote"),new KeyInfo("!\n1",1,"Digit1"),new KeyInfo("@\n2",1,"Digit2"),new KeyInfo("#\n3",1,"Digit3"),new KeyInfo("$\n4",1,"Digit4"),new KeyInfo("%\n5",1,"Digit5"),new KeyInfo("^\n6",1,"Digit6"),new KeyInfo("&\n7",1,"Digit7"),new KeyInfo("*\n8",1,"Digit8"),new KeyInfo("(\n9",1,"Digit9"),new KeyInfo(")\n0",1,"Digit0"),new KeyInfo("_\n-",1,"Minus"),new KeyInfo("+\n=",1,"Equal"),new KeyInfo("BACKSPACE",2,"Backspace"),new KeySpace(.5),new KeyInfo("INS",1,"Insert"),new KeyInfo("HOME",1,"Home"),new KeyInfo("PAGE UP",1,"PageUp")],[new KeyInfo("TAB",1.55,"Tab"),new KeyInfo("Q",1,"KeyQ"),new KeyInfo("W",1,"KeyW"),new KeyInfo("E",1,"KeyE"),new KeyInfo("R",1,"KeyR"),new KeyInfo("T",1,"KeyT"),new KeyInfo("Y",1,"KeyY"),new KeyInfo("U",1,"KeyU"),new KeyInfo("I",1,"KeyI"),new KeyInfo("O",1,"KeyO"),new KeyInfo("P",1,"KeyP"),new KeyInfo("{\n[",1,"BracketLeft"),new KeyInfo("}\n]",1,"BracketRight"),new KeyInfo("|\n\\",1.45,"Backslash"),new KeySpace(.5),new KeyInfo("DEL",1,"Delete"),new KeyInfo("END",1,"End"),new KeyInfo("PAGE DOWN",1,"PageDown")],[new KeyInfo("CAPS LCK",1.9,"CapsLock"),new KeyInfo("A",1,"KeyA"),new KeyInfo("S",1,"KeyS"),new KeyInfo("D",1,"KeyD"),new KeyInfo("F",1,"KeyF"),new KeyInfo("G",1,"KeyG"),new KeyInfo("H",1,"KeyH"),new KeyInfo("J",1,"KeyJ"),new KeyInfo("K",1,"KeyK"),new KeyInfo("L",1,"KeyL"),new KeyInfo(":\n;",1,"Semicolon"),new KeyInfo("\"\n'",1,"Quote"),new KeyInfo("ENTER",2.25,"Enter")],[new KeyInfo("",2.65,"ShiftLeft"),new KeyInfo("Z",1,"KeyZ"),new KeyInfo("X",1,"KeyX"),new KeyInfo("C",1,"KeyC"),new KeyInfo("V",1,"KeyV"),new KeyInfo("B",1,"KeyB"),new KeyInfo("N",1,"KeyN"),new KeyInfo("M",1,"KeyM"),new KeyInfo("<\n,",1,"Comma"),new KeyInfo(">\n.",1,"Period"),new KeyInfo("?\n/",1,"Slash"),new KeyInfo("",2.65,"ShiftRight"),new KeySpace(.5),new KeySpace(1),new KeyInfo("",1,"ArrowUp")],[new KeyInfo("CTRL",1.5,"ControlLeft"),new KeyInfo("FN",1,void 0),new KeyInfo("CMD",1.5,"MetaLeft"),new KeyInfo("ALT",1.5,"AltLeft"),new KeyInfo(" ",5.9,"Space"),new KeyInfo("ALT",1.5,"AltRight"),new KeyInfo("MENU",1.5,"ContextMenu"),new KeyInfo("CTRL",1.5,"ControlRight"),new KeySpace(.5),new KeyInfo("",1,"ArrowLeft"),new KeyInfo("",1,"ArrowDown"),new KeyInfo("",1,"ArrowRight")]],l=.34,u=.015,d=.13;class ProceduralKeyboardMesh extends i.Mesh{constructor(){super(Object(s.b)(l,u,d),r.a.keyboardPlastic),this.onKeyCodeEvent=(e,t)=>{this.buttonsByEventCode.has(e)&&(this.buttonsByEventCode.get(e).position.y=t?u-.012:u-.0075)},this.castShadow=!0,this.receiveShadow=!0,this.renderOrder=-2;const e=new Map,t=.15*c;let n=.5*-d+.01,i=0;for(const r of h){1===i&&(n+=.5*(c+t)),i++,n+=.5*(c+t);let s=.5*-l+.01;for(const i of r){if(s+=.5*(i.width+t),""!==i.label){const t=new o.a(i.width+.004,.012,c+.004,.001);this.add(t),t.position.set(s,u-.005,n);const r=new a.a(i.width,.01,c,i.label,.0015);void 0===i.eventCode||e.has(i.eventCode)||e.set(i.eventCode,r),this.add(r),r.position.set(s,u-.0075,n)}s+=.5*(i.width+t)}n+=.5*(c+t)}this.buttonsByEventCode=e,this.position.y+=u}}},function(e,t,n){"use strict";n.d(t,"a",function(){return KeyButtonMesh});var i=n(0),r=n(98),s=n(13),o=n(11),a=n(14),c=n(21),h=n(45);const l=a.a.keyLabel,u=a.a.keyLabelDouble,d=a.a.keyLabelSmall;function getFont(e){if(e.length>1&&e.length<=3&&"F"===e[0]){const t=e.split("F");if(Object(r.isNumber)(t[1]))return u}switch(e.length){case 1:return l;case 2:return d;case 3:return e.includes("\n")?u:d;default:return d}}class KeyButtonMesh extends i.Mesh{constructor(e,t,n,i="",r=.005){if(super(Object(c.a)(e,t,n,r),s.a.keyboardPlasticKey),""!==i){const t=new o.a(i,{...getFont(i),width:(e-.003)*h.a});t.position.y+=.0052,t.rotation.x=.5*-Math.PI,this.add(t)}this.renderOrder=10,this.castShadow=!0,this.receiveShadow=!0}}},function(e,t,n){"use strict";n.d(t,"a",function(){return TestKeyboardInputScene});var i=n(28),r=n(51),s=n(12);class TestKeyboardInputScene extends s.a{constructor(){super(!1);const e=new r.a;Object(i.a)().addListener(e.onKeyCodeEvent),this.scene.add(e),e.scale.multiplyScalar(10)}update(e){super.update(e)}render(e,t){super.render(e,t)}}},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return s});var i=n(0);const r=new i.Color(0),s=new i.Color(16777215);new i.Color(6750054),new i.Color(2273279),new i.Color(6750054),new i.Color(16711680),new i.Color(16050242)},,,function(e,t,n){"use strict";n.d(t,"b",function(){return SingleEnvironmentBlockQueryCallBack}),n.d(t,"a",function(){return SingleArchitectureBodyQueryCallBack});var i=n(1),r=n(3);class SingleEnvironmentBlockQueryCallBack extends i.QueryCallback{constructor(e){super(),e&&(this.clickedGameSpace=e)}reset(){this.environmentBlockBody=void 0}ReportFixture(e){const t=e.GetShape();if("environment"===Object(r.o)(e.m_filter.categoryBits)){if(t.TestPoint(e.GetBody().GetTransform(),this.clickedGameSpace))return this.environmentBlockBody=e.GetBody(),!1}return!0}}class SingleArchitectureBodyQueryCallBack extends i.QueryCallback{constructor(e){super(),e&&(this.clickedGameSpace=e)}reset(){this.architectureBody=void 0}ReportFixture(e){const t=e.GetShape();if("architecture"===Object(r.o)(e.m_filter.categoryBits)){if(t.TestPoint(e.GetBody().GetTransform(),this.clickedGameSpace))return this.architectureBody=e.GetBody(),!1}return!0}}},function(e,t,n){"use strict";function getHorizontalBias(e){switch(e){case"left":return 0;case"center":return-.5;case"right":return-1;default:return 0}}function getVerticalBias(e){switch(e){case"top":return 1;case"center":return.5;case"bottom":default:return 0}}n.d(t,"a",function(){return getHorizontalBias}),n.d(t,"b",function(){return getVerticalBias})},function(e,t,n){"use strict";n.d(t,"a",function(){return loadJson}),n.d(t,"b",function(){return loadTexture});var i=n(0);const r=new i.LoadingManager;let s,o;async function loadJson(e){return new Promise((t,n)=>(function getFileLoader(){return s||(s=new i.FileLoader(r)),s})().load(e,e=>t(JSON.parse(e)),void 0,n))}const a=new Map;async function loadTexture(e,t){let n;return n=a.has(e)?new Promise((t,n)=>{a.get(e).push(t)}):new Promise((n,s)=>{a.set(e,[n]);(function getTextureLoader(){return o||(o=new i.TextureLoader(r)),o})().load(e,n=>{n.name=e,void 0!==t&&(n.flipY=t),a.get(e).forEach(e=>e(n)),a.delete(e)},void 0,s)})}},function(e,t,n){"use strict";n.d(t,"a",function(){return makeWobblyCircleShapePath});var i=n(0);function makeWobblyCircleShapePath(e=.02,t=.03,n=20,r=3,s=0){const o=[],a=t-e;for(let t=0;t<n;t++){const c=t/n,h=2*Math.PI*(c+s),l=e+(.5*Math.sin(h*r)+.5)*a,u=new i.Vector2(Math.cos(h)*l,Math.sin(h)*l);o.push(u)}return o}},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",function(){return KeyboardInput});var i=n(6);class KeyboardInput{constructor(e=!1){this._preventDefault=e,this._listeners=[],this._keyStates=new Map,this.onKeyEvent=(e,t)=>{const n=e.code;this._preventDefault&&e.preventDefault(),this._keyStates.set(n,t);for(const e of this._listeners)e(n,t)},window.addEventListener("keydown",e=>this.onKeyEvent(e,!0)),window.addEventListener("keyup",e=>this.onKeyEvent(e,!1))}addListener(e){this._listeners.push(e)}removeListener(e){Object(i.e)(this._listeners,e)}}},function(e,t,n){"use strict";n.d(t,"a",function(){return Box2DPreviewMaterial});var i=n(0),r=n(72),s=n.n(r),o=n(73),a=n.n(o);class Box2DPreviewMaterial extends i.RawShaderMaterial{constructor(){super({vertexShader:a(),fragmentShader:s(),transparent:!0,depthWrite:!1,depthTest:!1})}}},function(e,t){e.exports="precision lowp float;\n#define GLSLIFY 1\n\nvarying vec4 vColor;\n\nvoid main() {\n\tgl_FragColor = vColor;\n}\n"},function(e,t){e.exports="precision lowp float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 color;\n\nvarying vec4 vColor;\n\nvoid main() {\n    gl_Position = vec4(position, 0.0, 1.0);\n    vColor = color;\n}"},function(e,t,n){"use strict";n.d(t,"a",function(){return BaseContactListener});var i=n(1),r=n(3),s=n(35);class BaseContactListener extends i.ContactListener{constructor(){super(...arguments),this._healthChangeCallbacks=[]}listenForHealthChanges(e){this._healthChangeCallbacks.push(e)}BeginContact(e){const t=e.GetFixtureA(),n=e.GetFixtureB(),i=r.o,s=i(t.m_filter.categoryBits),o=i(n.m_filter.categoryBits);"architecture"===s&&"penalty"===o?this._architectureHitsPenalty(t,n):"architecture"===o&&"penalty"===s&&this._architectureHitsPenalty(n,t)}EndContact(e){const t=e.GetFixtureA(),n=e.GetFixtureB(),i=r.o;i(t.m_filter.categoryBits),i(n.m_filter.categoryBits)}_architectureHitsPenalty(e,t){for(const e of this._healthChangeCallbacks)e(-1);Object(s.b)(e)}}BaseContactListener.k_maxContactPoints=2048},function(e,t,n){"use strict";n.d(t,"a",function(){return cloneMeshByName});var i=n(0);function cloneMeshByName(e,t,n=!1){let r;if(e.scene.traverse(e=>{e instanceof i.Mesh&&e.name===t&&(r=e)}),r)return r.clone(n);throw new Error(`Mesh named "${t}" not found in GLTF`)}},,function(e,t){e.exports="#ifdef GL_OES_standard_derivatives\n  #extension GL_OES_standard_derivatives : enable\n#endif\n\nprecision highp float;\n#define GLSLIFY 1\n\n#ifdef USE_ALPHATEST\nuniform float alphaTest;\n#endif\n\nuniform sampler2D msdf;\nuniform vec2 msdfSize;\n//uniform vec3 color;\nuniform float opacity;\n\n#ifdef USE_STROKE\nuniform float strokeWidth;\nuniform float strokeBias;\nuniform vec3 strokeColor;\n#endif\n\nvarying vec2 vUv;\nvarying vec3 vColor;\nvarying float vWeight;\n\nfloat median(float r, float g, float b) {\n  return max(min(r, g), min(max(r, g), b));\n}\n\n#ifdef USE_SHADOW\nconst vec2 shadowVector = vec2(-0.00025, 0.0005);\nconst float shadowSoftness = 0.5;\nconst float shadowShrink = 0.2;\nconst float shadowOpacity = 0.5;\n#endif\n\nconst float contrastMultiplier = 80.0;\n\nvoid main() {\n  vec3 color = vColor;\n\n  vec3 sample = texture2D(msdf, vUv + vec2(0.0, -0.5/512.0)).rgb;\n  float unsignedDistance = median(sample.r, sample.g, sample.b);\n\n  float signedDistance = unsignedDistance - (1.0 - 0.5 * vWeight);\n\n  if ( unsignedDistance == 0.0 ) discard;\n  float contrast = contrastMultiplier;\n  \n  //float contrast = (abs(dFdx(vUv.x)) + abs(dFdy(vUv.y))) * contrastMultiplier;\n\n  #ifdef USE_STROKE\n    float distanceOpacity = signedDistance + (strokeWidth * strokeBias);\n    float sigDistSrokeInner = signedDistance - (strokeWidth * (1.0 - strokeBias));\n    float colorMix = 1.0 - smoothstep(0.0, 1.0, sigDistSrokeInner / contrast + 0.5);\n    vec3 finalColor = mix(color, strokeColor, colorMix);\n  #else\n    float distanceOpacity = signedDistance;\n    vec3 finalColor = color;\n  #endif\n  \n  float alpha = smoothstep(0.0, 1.0, distanceOpacity / contrast + 0.5);\n  \n  #ifdef USE_SHADOW\n    //compute shadows\n    //shadow color is the same as stroke color for now\n    sample = texture2D(msdf, vUv + shadowVector).rgb;\n    unsignedDistance = median(sample.r, sample.g, sample.b);\n    float shadow = clamp(((unsignedDistance - shadowShrink) / shadowSoftness + shadowShrink), 0.0, 1.0) * shadowOpacity;\n    alpha = max(alpha, shadow);\n  #else \n    #ifdef USE_ALPHATEST\n      if ( alpha < alphaTest ) discard;\n    #endif\n  #endif\n  gl_FragColor = vec4(finalColor, alpha * opacity);\n}"},function(e,t,n){"use strict";n.d(t,"a",function(){return r});const i={align:"center",vAlign:"center"},r={centered:i,left:{...i,align:"left"},right:{...i,align:"right"},title:{...i,width:300}}},function(e,t){e.exports="#define GLSLIFY 1\nattribute vec2 uv;\nattribute vec4 position;\nattribute vec3 color;\nattribute float weight;\n\n#ifdef USE_SCREENSPACE\nuniform vec2 offset;\nuniform float prescale;\nuniform vec4 clipSpacePosition;\nuniform vec2 pixelSizeInClipSpace;\n#else\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\n#endif\nvarying vec2 vUv;\nvarying vec3 vColor;\nvarying float vWeight;\n\nvoid main() {\n  vUv = uv;\n  vColor = color;\n  vWeight = weight;\n\n  #ifdef USE_SCREENSPACE\n    vec2 finalOffset = (offset + position.xy) * pixelSizeInClipSpace * prescale;\n    #ifdef CONSTANT_SIZE_ON_SCREEN\n     finalOffset *= clipSpacePosition.w;\n    #endif\n    gl_Position = clipSpacePosition;\n    gl_Position.xy += finalOffset;\n  #else\n    gl_Position = projectionMatrix * modelViewMatrix * position;\n  #endif\n}"},function(e,t,n){"use strict";n.d(t,"a",function(){return SimpleGUIOverlay});var i=n(0),r=n(2),s=n(25),o=n(11),a=n(6);class SimpleGUIOverlay{constructor(){this._narrowerWindowDimension=window.innerWidth<window.innerHeight?window.innerWidth:window.innerHeight,this._squareButtonDimensions=2,this._scene=new i.Scene,this._camera=new i.OrthographicCamera(0,window.innerWidth,0,window.innerHeight,-100,100),this._fixedRadius=33.3,this._uiMeshes=[],this._uiButtonMeshes=[],this._imageLoader=new i.TextureLoader,this._scene.add(this._camera),"landscape"===r.a.orientation&&r.a.isMobile?(this._relativeWidthButtonSpacing=window.innerWidth/18,this._relativeHeightButtonSpacing=window.innerHeight/8):"portrait"===r.a.orientation&&r.a.isMobile?(this._relativeHeightButtonSpacing=window.innerHeight/18,this._relativeWidthButtonSpacing=window.innerWidth/10):(this._relativeWidthButtonSpacing=window.innerWidth/18,this._relativeHeightButtonSpacing=window.innerHeight/8),r.a.onChange(()=>{this._camera.right=window.innerWidth,this._camera.bottom=window.innerHeight,this._camera.updateProjectionMatrix(),this._narrowerWindowDimension=window.innerWidth<window.innerHeight?window.innerWidth:window.innerHeight,"landscape"===r.a.orientation&&r.a.isMobile?(this._relativeWidthButtonSpacing=window.innerWidth/18,this._relativeHeightButtonSpacing=window.innerHeight/8):"portrait"===r.a.orientation&&r.a.isMobile?(this._relativeHeightButtonSpacing=window.innerHeight/18,this._relativeWidthButtonSpacing=window.innerWidth/10):(this._relativeWidthButtonSpacing=window.innerWidth/18,this._relativeHeightButtonSpacing=window.innerHeight/8)},!0)}rayCastForButton(e,t){const n=new i.Raycaster(new i.Vector3(e,t,-100),new i.Vector3(0,0,1),0,200).intersectObjects(this._uiButtonMeshes);for(const e of n)if(e.object.userData instanceof ToggleButtonUserData)return e.object.userData.hit(),!0;return!1}setPosition(e,t,n){e.position.set(t,n,0)}removeUI(e){return this._scene.remove(e),Object(a.e)(this._uiMeshes,e),e}removeButtonUI(e){return this._scene.remove(e),Object(a.e)(this._uiButtonMeshes,e),e}render(e){e.render(this._scene,this._camera)}async makeFullscreenIcon(e,t){const n=await this.getFullscreenEnterTexture(),r=await this.getFullscreenExitTexture(),o=n.image.width/n.image.height,a=new i.BoxBufferGeometry(this._squareButtonDimensions*o,this._squareButtonDimensions),c=this._makeUI(a,e,t,!0,void 0);return c.material=new i.MeshBasicMaterial({map:n,transparent:!0}),c.userData=new ToggleButtonUserData(e=>{e?(s.a.requestFullscreen(),c.material=new i.MeshBasicMaterial({map:r,transparent:!0})):(document.exitFullscreen(),c.material=new i.MeshBasicMaterial({map:n,transparent:!0}))}),c}async makeWhiteHeartIcon(e,t){const n=await this.getWhiteHeartTexture(),r=n.image.width/n.image.height,s=new i.BoxBufferGeometry(this._squareButtonDimensions*r,this._squareButtonDimensions),o=this._makeUI(s,e,t,void 0,void 0);return o.material=new i.MeshBasicMaterial({map:n,transparent:!0,depthWrite:!1}),o.scale.setScalar(16),o}makeTimerBar(e,t,n,i=!0){const r=this._makeUI(this.getTimerBarGeometry(),e,t,n,i);r.material.color.set("white"),r.material.opacity=.5;const s=new o.a("Time:");return s.scale.multiplyScalar(100),s.opacity=2,r.add(s),r}makeBiggerCircle(e,t){return this._makeUI(this.getBiggerCircleGeometry(),e,t)}makeBigCircle(e,t){return this._makeUI(this.getBigCircleGeometry(),e,t)}makeMediumCircle(e,t){return this._makeUI(this.getMediumCircleGeometry(),e,t)}makeSmallCircle(e,t){return this._makeUI(this.getSmallCircleGeometry(),e,t)}makeSmallSquare(e,t,n,i=!1){return this._makeUI(this.getSmallSquareGeometry(),e,t,n,i)}_makeUI(e,t,n,r,s=!1){const o=new i.Mesh(e,this.getMaterial(s));return o.position.set(t,n,0),o.rotation.x=Math.PI,o.scale.setScalar(this._fixedRadius),this._scene.add(o),r?this._uiButtonMeshes.push(o):this._uiMeshes.push(o),o}getMaterial(e=!1){return this._material||(this._material=new i.MeshBasicMaterial({opacity:.3,transparent:!0})),e?this._material.clone():this._material}getFullscreenEnterTexture(){return this._fullscreenEnterTextureLoading||(this._fullscreenEnterTextureLoading=this._imageLoader.loadAsync("game/icons/fullscreen-enter.png"),this._fullscreenEnterTextureLoading.then(e=>{e.minFilter=i.NearestFilter,e.magFilter=i.NearestFilter})),this._fullscreenEnterTextureLoading}getFullscreenExitTexture(){return this._fullscreenExitTextureLoading||(this._fullscreenExitTextureLoading=this._imageLoader.loadAsync("game/icons/fullscreen-exit.png"),this._fullscreenExitTextureLoading.then(e=>{e.minFilter=i.NearestFilter,e.magFilter=i.NearestFilter})),this._fullscreenExitTextureLoading}getWhiteHeartTexture(){return this._whiteHeartTextureLoading||(this._whiteHeartTextureLoading=this._imageLoader.loadAsync("game/icons/heart-white.png"),this._whiteHeartTextureLoading.then(e=>{e.minFilter=i.NearestFilter,e.magFilter=i.NearestFilter})),this._whiteHeartTextureLoading}getBiggerCircleGeometry(){return this._geometryBigger||(this._geometryBigger=new i.CircleBufferGeometry(3.5,32)),this._geometryBigger}getBigCircleGeometry(){return this._geometryBig||(this._geometryBig=new i.CircleBufferGeometry(2.5,32)),this._geometryBig}getMediumCircleGeometry(){return this._geometryMedium||(this._geometryMedium=new i.CircleBufferGeometry(1,32)),this._geometryMedium}getSmallCircleGeometry(){return this._geometrySmall||(this._geometrySmall=new i.CircleBufferGeometry(.5,32)),this._geometrySmall}getSmallSquareGeometry(){return this._geometrySqaureSmall||(this._geometrySqaureSmall=new i.BoxBufferGeometry(this._squareButtonDimensions,this._squareButtonDimensions)),this._geometrySqaureSmall}getTimerBarGeometry(){return this._geometryTimerBar||(this._geometryTimerBar=new i.BoxBufferGeometry(1,1)),this._geometryTimerBar}}class ToggleButtonUserData{constructor(e){this.callback=e,this.enabled=!1}hit(){this.enabled=!this.enabled,this.callback(this.enabled)}}},function(e,t,n){"use strict";n.d(t,"a",function(){return NiceParameter});var i=n(6),r=n(82),s=n(5),o=n(4);const a=[];class NiceParameter{constructor(e,t,n,i,o,c,h,l,u=!1,d=.01,f=0){this.name=e,this.label=t,this.defaultValue=n,this.minValue=i,this.maxValue=o,this.step=d,this.distribution=c,this.valueTextConverter=h,this._availableToUserMethod=!0===l||!1===l?()=>l:l,this._listeners=[],u&&(this.value=this.defaultValue),this._value=Object(r.a)("nice-param-"+e,n,i,o);const p=Object(s.c)(e,this._value,i,o);p!==this._value&&(this.value=p),a.push(this),0===f&&(f=a.length),this.sliderOrderPriority=f}listen(e){this._listeners.push(e),e(this.value)}stopListening(e){Object(i.e)(this._listeners,e)}set value(e){e!==this._value&&(e=Object(o.b)(e,this.minValue,this.maxValue))!==this._value&&(this._value=e,localStorage.setItem("nice-param-"+this.name,String(e)),this._listeners.forEach(t=>t(e)))}get value(){return this._value}get availableToUser(){return this._availableToUserMethod()}}},function(e,t,n){"use strict";n.d(t,"a",function(){return getLocalStorageFloat});n(40);var i=n(4);function getLocalStorageParam(e){return localStorage.getItem(e)}function __getLocalStorageNumber(e,t,n,r=-1/0,s=1/0){return Object(i.b)(n(getLocalStorageParam(e)||t.toString()),r,s)}function getLocalStorageFloat(e,t,n=-1/0,i=1/0){return __getLocalStorageNumber(e,t,parseFloat,n,i)}},function(e,t,n){"use strict";n.d(t,"a",function(){return RafTweener});var i=n(84);class RafTweener extends i.a{constructor(e=0,t=!0){super(),this.discreteStepDuration=e,this.speed=1,this.requestStop=!1,this.paused=!1,this.ticking=!1,this.timeSnapshot=0,this.update=e>0?this.discreteStepTick:this.tick,this.rafTick=this._rafTick.bind(this),t&&this.start()}discreteStepTick(e){e*=this.speed;const t=this._now+e;for(;this._now<t;)this.tick(this.discreteStepDuration)}start(){this.timeSnapshot=performance.now(),this.discreteStepDuration>0&&(this.timeSnapshot-=this.timeSnapshot%this.discreteStepDuration),this._now=this.timeSnapshot,this.ticking||(this.ticking=!0,window.requestAnimationFrame(this.rafTick))}stop(){this.ticking&&!this.requestStop&&(this.requestStop=!0,this.ticking=!1)}pause(){this.paused=!0}unpause(){this.paused=!1}_rafTick(){if(this.requestStop)return void(this.requestStop=!1);const e=performance.now();let t=(e-this.timeSnapshot)*this.speed;if(this.paused)t=0;else{const e=this._now;this.update(t),t-=this._now-e}this.timeSnapshot=e-t,this.ticking&&window.requestAnimationFrame(this.rafTick)}}},function(e,t,n){"use strict";n.d(t,"a",function(){return RawTweener});var i=n(85),r=n(4);const s={delay:0,duration:1e3,easing:n(19).a.Linear};class AnimatedProperty{constructor(e,t,n){this.key=e,this.valueStart=t,this.valueEnd=n}}class AnimatedObject{constructor(e,t,n,i,r,s,o,a){this.tweener=e,this.target=t,this.easing=n,this.startTime=i,this.endTime=r,this.animatedProperties=s,this.onUpdate=o,this.duration=r-i,this.finished=new Promise(e=>{this.onComplete=()=>{a&&a(),e()}})}kill(){this.tweener.kill(this)}}class RawTweener{constructor(){this._now=0,this._processingTick=!1,this._animations=[],this._animationsToComplete=[]}to(e){if(this.killTweensOf(e.target),Object(i.a)(e,s),"function"!=typeof e.easing)throw new Error("ease must be an easing function that takes in a number (0..1) and returns a number (0..1)");const t=e.target,n=e.propertyGoals,r=Object.keys(n).map(e=>{const i=t[e],r=n[e];if(isNaN(i)||isNaN(r))throw new Error("values must be numbers");return new AnimatedProperty(e,i,r)}),o=this._now+e.delay,a=o+e.duration,c=new AnimatedObject(this,t,e.easing,o,a,r,e.onUpdate,e.onComplete);return this._animations.push(c),c}tick(e){this._now+=e;const t=this._now,n=this._animations;this._processingTick=!0;for(const e of n)if(t>e.startTime){const n=e.target,i=Math.min((t-e.startTime)/e.duration,1);if(i<1){const t=e.easing(i);for(const i of e.animatedProperties)n[i.key]=Object(r.e)(i.valueStart,i.valueEnd,t);e.onUpdate&&e.onUpdate()}else this._animationsToComplete.push(e)}if(this._processingTick=!1,this._animationsToComplete.length>0){this._animationsToComplete.sort((e,t)=>e.endTime-t.endTime);for(const e of this._animationsToComplete)this.kill(e);this._animationsToComplete.length=0}}killTweensOf(e){if(this._processingTick)throw new Error("Not allowed during processing of tick");const t=this._animations;for(let n=t.length-1;n>=0;n--){const i=t[n];i.target===e&&this.kill(i,n)}}kill(e,t=-1){if(this._processingTick)throw new Error("Not allowed during processing of tick");if(-1===t&&(t=this._animations.indexOf(e)),-1!==t){for(const t of e.animatedProperties)e.target[t.key]=t.valueEnd;e.onUpdate&&e.onUpdate(),e.onComplete&&e.onComplete(),this._animations.splice(t,1)}}}},function(e,t,n){"use strict";function copyDefaults(e,t){for(const n of Object.keys(t))e.hasOwnProperty(n)||(e[n]=t[n])}n.d(t,"a",function(){return copyDefaults})},function(e,t,n){"use strict";n.d(t,"a",function(){return startControls});var i=n(44);function startControls(e,t,n,r,s){const o=[];Object(i.b)(s,n);return e=>{for(const t of o)t(e)}}},function(e,t,n){"use strict";n.d(t,"a",function(){return getMetaContactListener});var i=n(88);let r;function getMetaContactListener(){return r||(r=new i.a),r}},function(e,t,n){"use strict";n.d(t,"a",function(){return MetaContactListener});var i=n(1);class MetaContactListener extends i.ContactListener{constructor(){super(...arguments),this.registry=[]}register(e){this.registry.push(e)}BeginContact(e){for(const t of this.registry)t.BeginContact(e)}EndContact(e){for(const t of this.registry)t.EndContact(e)}BeginContactFixtureParticle(e,t){for(const n of this.registry)n.BeginContactFixtureParticle(e,t)}EndContactFixtureParticle(e,t){for(const n of this.registry)n.EndContactFixtureParticle(e,t)}BeginContactParticleParticle(e,t){for(const n of this.registry)n.BeginContactParticleParticle(e,t)}EndContactParticleParticle(e,t){for(const n of this.registry)n.EndContactParticleParticle(e,t)}PreSolve(e,t){for(const n of this.registry)n.PreSolve(e,t)}PostSolve(e,t){for(const n of this.registry)n.PostSolve(e,t)}}},function(e,t,n){"use strict";n.d(t,"a",function(){return TestCharacterControlScene});var i=n(8),r=n(3),s=n(9);class TestCharacterControlScene extends s.a{constructor(){super(!1,20,!1),i.b.value=!0;for(let e=0;e<10;e++)Object(r.g)(this.b2World,e-5,-.3,.5,.1)}update(e){super.update(e),this._postUpdate(e)}}},function(e,t,n){"use strict";n.d(t,"a",function(){return TestCharacterControlOnTextScene});var i=n(8),r=n(3),s=n(9),o=n(47);class TestCharacterControlOnTextScene extends s.a{constructor(){super(!1,20,!1),i.b.value=!0;for(let e=0;e<10;e++)Object(r.g)(this.b2World,e-5,-.3,.5,.1);Object(o.b)(this.scene,this.b2World)}update(e){super.update(e),this._postUpdate(e)}}},,function(e,t,n){"use strict";n.d(t,"a",function(){return TestGraphics3D});var i=n(1),r=n(0),s=n(29),o=n(2),a=n(93),c=n(19),h=n(15),l=n(5),u=n(4),d=n(39),f=n(12);class TestGraphics3D extends f.a{constructor(){super(!1,!1),this.useB2Preview=Object(l.b)("debugPhysics"),this.camera.position.set(0,0,5),this.camera.lookAt(new r.Vector3(0,0,0));const e=new r.Plane(new r.Vector3(0,0,-1));this.b2World=new d.a((t,n)=>{const r=new i.Vec2(t,n),s=Object(u.c)(t/o.a.width*2-1,-(n/o.a.height*2-1),e,this.camera);return s&&(r.x=s.x,r.y=s.y),r},()=>{h.a.to({target:this.camera.position,propertyGoals:{y:this.camera.position.y+1},easing:c.a.Quartic.InOut,duration:2e3}),this.heightGoal&&h.a.to({target:this.heightGoal.position,propertyGoals:{y:this.heightGoal.position.y+1},easing:c.a.Quartic.InOut,duration:2e3}),this.dangerZone&&h.a.to({target:this.dangerZone.position,propertyGoals:{y:this.dangerZone.position.y+1},easing:c.a.Quartic.InOut,duration:2e3})},()=>{h.a.to({target:this.camera.position,propertyGoals:{y:0},easing:c.a.Quartic.InOut,duration:2e3}),this.heightGoal&&h.a.to({target:this.heightGoal.position,propertyGoals:{y:-.25},easing:c.a.Quartic.InOut,duration:2e3}),this.dangerZone&&h.a.to({target:this.dangerZone.position,propertyGoals:{y:-1.55},easing:c.a.Quartic.InOut,duration:2e3})}),this.b2World.autoClear=!1,this.graphicsPack=new a.a(this.scene);(async()=>{const e=new s.a,t=await e.loadAsync("game/models/art.glb");for(const e of t.scene.children)e.traverse(e=>{e instanceof r.Mesh&&(e.castShadow=!0,e.receiveShadow=!0)});const n=t.scene,i=n.getObjectByName("heightGoal"),o=n.getObjectByName("dangerZone"),a=n.getObjectByName("sky");if(n.scale.multiplyScalar(.1),n.rotation.y+=Math.PI,n.position.y-=1.5,this.scene.add(n),i&&(i.scale.multiplyScalar(2),this.scene.attach(i),i.castShadow=!1,i.receiveShadow=!1,i.position.y=-.25),o&&(o.scale.multiplyScalar(2),this.scene.attach(o),o.position.y=-1.55,o instanceof r.Mesh&&o.material instanceof r.MeshStandardMaterial)){o.castShadow=!1,o.receiveShadow=!1;const e=o.material.map;o.material=new r.MeshBasicMaterial({map:e,transparent:!0,opacity:.5})}if(a&&a instanceof r.Mesh&&a.material instanceof r.MeshStandardMaterial){a.castShadow=!1,a.receiveShadow=!1;const e=a.material.map,t=new r.Color(2,2,2);a.material=new r.MeshBasicMaterial({map:e,fog:!0,color:t})}this.heightGoal=i,this.dangerZone=o})()}update(e){this.b2World.update(e),this.graphicsPack.update(e),super.update(e)}render(e,t){super.render(e,t),this.useB2Preview&&this.b2World.render(e,t),this.b2World.gui.render(e)}}},function(e,t,n){"use strict";n.d(t,"a",function(){return TestGraphicsPack});var i=n(42),r=n(17);class TestGraphicsPack{constructor(e){this.bodyMeshMap=new Map,Object(r.a)().startListeningForCreate((t,n)=>{e.add(n),this.bodyMeshMap.set(t,n)}),Object(r.a)().startListeningForDestroy(t=>{const n=i.a.deleteMesh(t);n&&e.remove(n)})}update(e){this.bodyMeshMap.forEach((e,t)=>{e.position.x=t.GetPosition().x,e.position.y=t.GetPosition().y,e.rotation.y=t.GetAngle()})}}},function(e,t,n){"use strict";n.d(t,"a",function(){return addPrettyLights});var i=n(0),r=n(5);const s=new i.Color(5193519).multiplyScalar(1.8),o=new i.Color(11517935).multiplyScalar(1.8),a=new i.Vector3(8,2,6),c=new i.Vector3(0,.5,.4),h=new i.Vector3;function addPrettyLights(e,t){const n=new i.HemisphereLight(o,s);e.add(n);const l=new i.DirectionalLight(16777135,.75);e.add(l),l.name="sunlight",l.castShadow=!0,l.shadow.camera.near=.1,l.shadow.camera.far=10,l.shadow.camera.left=-5,l.shadow.camera.right=5,l.shadow.camera.top=-3,l.shadow.camera.bottom=3,l.shadow.camera.updateProjectionMatrix(),l.shadow.mapSize.width=l.shadow.mapSize.height=1024,l.shadow.bias=-.0025;l.position.set(5*Math.cos(.6),5*Math.sin(.6),0),l.lookAt(h),l.updateMatrix(),l.updateMatrixWorld(!0);const u=l.shadow.camera;u.updateMatrix(),u.updateMatrixWorld(!0),u.top=-1/0,u.bottom=1/0,u.left=1/0,u.right=-1/0,u.near=1/0,u.far=-1/0;const d=new i.Vector3;for(let e=0;e<8;e++)d.x=e%2-.5,d.y=-(~~(e/2)%2-.5),d.z=~~(e/4)%2-.5,d.multiply(a),d.sub(c),l.worldToLocal(d),u.top=Math.max(u.top,-d.y),u.bottom=Math.min(u.bottom,-d.y),u.left=Math.min(u.left,d.x),u.right=Math.max(u.right,d.x),u.near=Math.min(u.near,d.z+10),u.far=Math.max(u.far,d.z+10);if(u.updateProjectionMatrix(),Object(r.b)("debugLights")){const t=new i.DirectionalLightHelper(l),n=new i.CameraHelper(l.shadow.camera);e.add(t),e.add(n),t.update(),n.update()}return e.fog=new i.Fog(t.getHex(),0,50),{sunLight:l,ambientLight:n}}},function(e,t,n){"use strict";n.d(t,"a",function(){return TestGraphicsCharacterScene});var i=n(96),r=n(5),s=n(49);class TestGraphicsCharacterScene extends s.a{constructor(){super("test-layout");const e=new i.a;this.b2World.SetContactListener(e);for(let e=0;e<Object(r.d)("characters",1,1,4);e++);}update(e){super.update(e),this.sunLight.position.x=this.camera.position.x+.2,this.sunLight.target.position.x=this.camera.position.x,this.sunLight.target.updateMatrixWorld(!0),this.sunLight.updateMatrixWorld(!0)}}},function(e,t,n){"use strict";n.d(t,"a",function(){return AvatarContactListener});var i=n(1),r=n(3),s=n(6);class AvatarContactListener extends i.ContactListener{constructor(){super(),this.contactPairs=new Map,this.sensorBeginCallbacks=new Map,this.sensorEndCallbacks=new Map}listenForSensorBeginContact(e,t){Object(s.d)(this.sensorBeginCallbacks,e,t)}listenForSensorEndContact(e,t){Object(s.d)(this.sensorEndCallbacks,e,t)}BeginContact(e){const t=Object(r.k)(e);if(t){if(this.sensorBeginCallbacks.has(t.sensor))for(const e of this.sensorBeginCallbacks.get(t.sensor))e(t.rigidBody);Object(s.d)(this.contactPairs,t.sensor,t.rigidBody)}}EndContact(e){const t=Object(r.k)(e);if(t){if(this.sensorEndCallbacks.has(t.sensor))for(const e of this.sensorEndCallbacks.get(t.sensor))e(t.rigidBody);t&&Object(s.a)(this.contactPairs,t.sensor,t.rigidBody)}}}},function(e,t,n){"use strict";n.d(t,"a",function(){return KeyButtonHoleMesh});var i=n(0),r=n(13),s=n(21);class KeyButtonHoleMesh extends i.Mesh{constructor(e,t,n,i=.005){super(Object(s.a)(e+.001,t,n+.001,2*i),r.a.keyboardPlasticHole),this.renderOrder=-1,this.receiveShadow=!0}}},,function(e,t,n){"use strict";n.d(t,"a",function(){return TestKeyboardCharacterScene});var i=n(8),r=n(20),s=n(53),o=n(9);class TestKeyboardCharacterScene extends r.a{constructor(){super();const e=new s.a,t=new o.a;this.scenes=[e,t],this.scenes[1].autoClear=!1,i.b.value=!0}update(e){for(const t of this.scenes)t.update(e)}render(e,t){for(const n of this.scenes)n.render(e,t)}}},function(e,t,n){"use strict";n.d(t,"a",function(){return TestLitModelsScene});var i=n(29),r=n(12);class TestLitModelsScene extends r.a{constructor(){super(!1,!1);(async()=>{const e=new i.a,t=await e.loadAsync("game/models/columns.glb");for(const e of t.scene.children.slice()){this.scene.add(e),e.position.z+=1,e.castShadow=!0,e.receiveShadow=!0;const t=Math.sqrt(Math.pow(e.position.x,2)+Math.pow(e.position.z,2)),n=Math.atan2(e.position.z,e.position.x)+.5*Math.PI;e.position.set(Math.cos(n)*t,e.position.y,Math.sin(n)*t)}})()}}},function(e,t,n){"use strict";n.d(t,"a",function(){return TestConcaveBodiesScene});var i=n(1),r=n(0),s=n(8),o=n(60),a=n(3),c=n(9);class TestConcaveBodiesScene extends c.a{constructor(){super(!1,20,!1),this.postUpdates=[],s.b.value=!0;for(let e=0;e<10;e++)Object(a.g)(this.b2World,e-5,-.3,.5,.1);const e=Object(o.a)(.1,.25,40,6);Object(a.j)(void 0,e,i.BodyType.b2_staticBody,new r.Vector2(-.5,0),a.h);const t=Object(o.a)(.2,.125,12,3,.25),n=new r.Vector2(-1,0);Object(a.j)(void 0,t,i.BodyType.b2_staticBody,n,a.i)}update(e){super.update(e);for(const t of this.postUpdates)t(e)}}},function(e,t,n){"use strict";n.d(t,"a",function(){return TestPhysicsMeshDerivativeBodiesScene});var i=n(8),r=n(41),s=n(3),o=n(9);class TestPhysicsMeshDerivativeBodiesScene extends o.a{constructor(){super(!1,20,!1),this.postUpdates=[],i.b.value=!0;for(let e=0;e<10;e++)Object(s.g)(this.b2World,e-5,-.3,.5,.1);(async()=>{const e=this.b2World.CreateBody();Object(r.a)(e,"column1","collider1")})()}update(e){super.update(e);for(const t of this.postUpdates)t(e)}}},function(e,t,n){"use strict";n.d(t,"a",function(){return TestPhysicsPNGScene});var i=n(3),r=n(50),s=n(5),o=n(9);class TestPhysicsPNGScene extends o.a{constructor(e="test",t=20,n){super(!1,t);new r.a(Object(s.e)("level")||e,i.d.bind(this,this.b2World),n)}}},function(e,t,n){"use strict";n.d(t,"a",function(){return TestStencilsScene});var i=n(105),r=n(12);class TestStencilsScene extends r.a{constructor(){super();const e=new i.a(.013,.012);e.rotation.y+=-.15*Math.PI,e.position.set(0,.15,.3),this.scene.add(e),this.characterMesh=e}update(e){super.update(e),this.characterMesh.rotation.z+=.5*e}}},function(e,t,n){"use strict";n.d(t,"a",function(){return CharacterMesh});var i=n(0),r=n(106),s=n(13),o=n(52);let a=13;class CharacterMesh extends o.a{constructor(e,t,n=""){super(e,t,e,n,.01);const o=new i.SphereBufferGeometry(.045,16,8),c=o.attributes.position.array;for(let e=1;e<c.length;e+=3)c[e]<0&&(c[e]=0);const h=new i.Mesh(o,s.a.keyboardPlasticKeyUnderside);h.receiveShadow=!0,h.renderOrder=a,a+=2,h.position.y=.5*-t-1e-4,h.rotation.y=2*Math.PI/32,this.add(h),Object(r.a)(h),this.castShadow=!0,this.receiveShadow=!0}}},function(e,t,n){"use strict";n.d(t,"a",function(){return makeScoopMesh});var i=n(0),r=n(13);function makeScoopMesh(e){const t=new i.Mesh(e.geometry,r.a.scoopMask);t.renderOrder=e.renderOrder-1,e.add(t),t.onBeforeRender=(e,t,n,i,r,s)=>{!function maskPreRender(e,t){t.setTest(!0),t.setClear(1),t.setMask(255),t.setOp(e.KEEP,e.KEEP,e.REPLACE),t.setFunc(e.ALWAYS,2,255)}(e.context,e.state.buffers.stencil)},t.onAfterRender=(e,t,n,i,r,s)=>{e.context,e.state.buffers.stencil},e.onBeforeRender=(e,t,n,i,r,s)=>{!function meshPreRender(e,t){t.setFunc(e.EQUAL,2,255),t.setMask(0)}(e.context,e.state.buffers.stencil)},e.onAfterRender=(e,t,n,i,r,s)=>{!function meshPostRender(e,t){t.setTest(!1)}(e.context,e.state.buffers.stencil)}}},function(e,t,n){"use strict";n.d(t,"a",function(){return TestTextScene});var i=n(11),r=n(14),s=n(30),o=n(5),a=n(20);class TestTextScene extends a.a{constructor(){super();const e=new s.a(this.camera);Object(o.b)("fpsCam")&&e.toggle(!0);const t=new i.a("Hello World!");t.scale.multiplyScalar(10),this.scene.add(t);const n=new i.a("ANY KEY",r.a.title);n.scale.multiplyScalar(10),this.scene.add(n);const a=new i.a("Q W E R T Y",r.a.keyLabel);a.scale.multiplyScalar(10),a.position.y=-.4,this.scene.add(a);const c=new i.a("    ",r.a.keyLabel);c.scale.multiplyScalar(10),c.position.y=-.5,this.scene.add(c);(async()=>{})()}update(e){super.update(e)}render(e,t){super.render(e,t)}}},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(39),s=n(89),o=n(90),a=n(92),c=n(95),h=n(49),l=n(99),u=n(53),d=n(12),f=n(100),p=n(9),y=n(101),g=n(102),m=n(103),w=n(104),b=n(107),v=n(47),S=n(15),_=n(25),x=n(22),C=n(32),M=n(5),B=n(46),P=n(31),k=n(48);document.addEventListener("gesturestart",e=>e.preventDefault());const O=new i.Clock;_.b.setClearColor(new i.Color(3425622),1),C.a.camera.position.set(0,.5,.5),C.a.camera.lookAt(new i.Vector3);const T={characterControl:s.a,characterControlOnText:o.a,graphicsLevel:h.a,graphicsCharacter:c.a,keyboard:u.a,keyboardCharacter:l.a,lighting:d.a,litModels:f.a,physics:p.a,textPhysics:v.a,physicsConcave:y.a,physicsMeshDerivatives:g.a,physicsPNG:m.a,stencils:w.a,text:b.a,b2Preview:r.a,graphics3D:a.a};let A=d.a;const F=Object(M.e)("test")||"graphics3D",j=Object(M.d)("fps",60,1,240);T.hasOwnProperty(F)&&(A=T[F]);const I=new A;let L=0,K=0;const E=1/j;requestAnimationFrame(function loop(){requestAnimationFrame(loop);const e=Math.min(O.getDelta(),.1)*S.a.speed;(L+=e)-K>E&&(K+=E,Object(B.a)(),S.a.rafTick(),k.a.update(E),P.a.update(E),x.c.value+=E,I.update(E),I.render(_.b,E))})},,,,,,,,,,,,,,,,,function(e,t){},,function(e,t){}]);